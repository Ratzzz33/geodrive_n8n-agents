# Unit-тесты для TypeScript кода

## Описание

Этот каталог содержит unit-тесты для критичных компонентов системы:
- Telegram-бота (команды и обработчики)
- Оркестратора (маршрутизация событий)
- Конфигурации
- Интеграций (частично)

## Запуск тестов

### Все тесты:
```bash
npm test
```

### В режиме watch (автоматический перезапуск):
```bash
npm run test:watch
```

### С покрытием кода:
```bash
npm run test:coverage
```

Результаты покрытия будут в директории `coverage/`.

## Структура тестов

Тесты находятся рядом с исходными файлами:
- `src/bot/index.test.ts` - тесты для бота
- `src/orchestrator/index.test.ts` - тесты для оркестратора
- `src/config/index.test.ts` - тесты для конфигурации

## Написание новых тестов

1. Создайте файл `*.test.ts` рядом с тестируемым модулем
2. Используйте Vitest API:
   - `describe` - группировка тестов
   - `it` или `test` - отдельный тест
   - `expect` - assertions
   - `vi.mock` - моки зависимостей
   - `vi.fn` - моки функций

Пример:
```typescript
import { describe, it, expect, vi } from 'vitest';
import { myFunction } from './my-module';

describe('myFunction', () => {
  it('должен возвращать ожидаемое значение', () => {
    const result = myFunction('input');
    expect(result).toBe('expected');
  });
});
```

## CI/CD

Тесты автоматически запускаются в GitHub Actions при:
- Push в ветки master/main
- Создании Pull Request

## Приоритеты тестирования

1. ✅ Бот и команды - критично для работы системы
2. ✅ Оркестратор - критично для маршрутизации
3. ⚠️ Интеграции - частично (нужны моки внешних API)
4. ⚠️ Агенты - по мере разработки

## Зависимости

- `vitest` - тестовый фреймворк
- `@vitest/coverage-v8` - покрытие кода

## Покрытие кода

Цель покрытия на текущем этапе: **60-70%** для критичных компонентов.

Исключены из покрытия:
- Точки входа (`index.ts`)
- Конфигурационные файлы
- Типы и интерфейсы

