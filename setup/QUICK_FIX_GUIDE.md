# ‚ö° –ë–´–°–¢–†–´–ô –ì–ê–ô–î: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Company Cash Monitor

## üéØ –ß—Ç–æ –¥–µ–ª–∞–µ–º

–ó–∞–º–µ–Ω—è–µ–º **188 SQL –∑–∞–ø—Ä–æ—Å–æ–≤** ‚Üí –Ω–∞ **1 batch INSERT**

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –¥–µ–π—Å—Ç–≤–∏–π (5 –º–∏–Ω—É—Ç)

### 1Ô∏è‚É£ –û—Ç–∫—Ä—ã—Ç—å workflow
```
https://n8n.rentflow.rentals/workflow/w8g8cJb0ccReaqIE
```

### 2Ô∏è‚É£ –£–¥–∞–ª–∏—Ç—å 2 –Ω–æ–¥—ã
- ‚ùå **Split In Batches**
- ‚ùå **Pass Through Data**

### 3Ô∏è‚É£ –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é Code –Ω–æ–¥—É

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- Name: `Prepare Batch Insert`
- Type: `Code`

**–ö–æ–¥:** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ `setup/fix_cash_workflow_batch.mjs` (—Å–µ–∫—Ü–∏—è Code)

### 4Ô∏è‚É£ –û–±–Ω–æ–≤–∏—Ç—å Postgres –Ω–æ–¥—É

**–ù–æ–¥–∞:** `Save Payment to DB`

**SQL:** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ `setup/fix_cash_workflow_batch.mjs` (—Å–µ–∫—Ü–∏—è SQL)

### 5Ô∏è‚É£ –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å

```
Merge & Process
    ‚Üì
Prepare Batch Insert  ‚Üê –ù–û–í–ê–Ø –ù–û–î–ê
    ‚Üì
Save Payment to DB    ‚Üê –û–ë–ù–û–í–õ–Å–ù–ù–ê–Ø
    ‚Üì
Format Result
```

### 6Ô∏è‚É£ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å

- Click **Save**
- Click **Execute Workflow**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```
‚úÖ Prepared 188 rows for batch insert
Query executed successfully
Rows affected: 188
```

---

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

| –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|------|-------|
| 188 SQL –∑–∞–ø—Ä–æ—Å–æ–≤ | 1 SQL –∑–∞–ø—Ä–æ—Å |
| ~9 —Å–µ–∫—É–Ω–¥ | ~0.5 —Å–µ–∫—É–Ω–¥—ã |
| ‚ùå –ù–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å 10,000+ items |

**–£—Å–∫–æ—Ä–µ–Ω–∏–µ: √ó 18!**

---

## üìû –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —É–¥–∞–ª–µ–Ω—ã –æ–±–µ —Å—Ç–∞—Ä—ã–µ –Ω–æ–¥—ã
2. –ü—Ä–æ–≤–µ—Ä—å connections (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä—è–º–∞—è —Ü–µ–ø–æ—á–∫–∞)
3. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ "Prepare Batch Insert" –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `$input.all()`
4. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ SQL –µ—Å—Ç—å `{{ $json.batch_values }}`

---

**–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `CASH_WORKFLOW_BATCH_FIX.md`

