# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Starline GPS Monitor

**–î–∞—Ç–∞:** 2025-11-13  
**–ü—Ä–æ–±–ª–µ–º–∞:** Execution #10989 –∑–∞–Ω—è–ª ~100 —Å–µ–∫—É–Ω–¥, —É–ª—É—á—à–µ–Ω–∏—è –Ω–µ —É—Å–∫–æ—Ä–∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±—ã–ª–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ ‚ùå
- **–ù–∞–π–¥–µ–Ω–æ:** `STARLINE_PARALLEL_BATCH_SIZE=1` –≤ `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~100 —Å–µ–∫—É–Ω–¥ –¥–ª—è 105 —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏
- **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –ü—Ä–æ–∫—Å–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞
- **–õ–æ–≥–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç:**
  ```
  StarlineScraperService: üöÄ Creating fast context WITHOUT proxy...
  StarlineScraperService: ‚úÖ Persistent browser session initialized (proxy ‚Üí no proxy for speed)
  ```

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –í–∫–ª—é—á–µ–Ω–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
```bash
# –ò–∑–º–µ–Ω–µ–Ω–æ –≤ .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
STARLINE_PARALLEL_BATCH_SIZE=5  # –±—ã–ª–æ: 1
```

### 2. –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ rate limiting
- –ò–∑–º–µ–Ω–µ–Ω–æ —Å `logger.debug` –Ω–∞ `logger.info` –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤ –ª–æ–≥–∞—Ö

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω API
```bash
pm2 restart jarvis-api --update-env
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –í—Ä–µ–º—è: ~100 —Å–µ–∫—É–Ω–¥ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- –†–µ–∂–∏–º: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π (batch_size=1)

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –í—Ä–µ–º—è: ~25-30 —Å–µ–∫—É–Ω–¥ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞—Ç—á–∞–º–∏ –ø–æ 5)
- –†–µ–∂–∏–º: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π (batch_size=5)
- –£–ª—É—á—à–µ–Ω–∏–µ: **~3-4x –±—ã—Å—Ç—Ä–µ–µ**

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –õ–æ–≥–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
```
üìç –ù–∞—á–∏–Ω–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ GPS –¥–∞–Ω–Ω—ã—Ö (—Ä–µ–∂–∏–º: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π, –±–∞—Ç—á 5)...
üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ 104 —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –±–∞—Ç—á–∞–º–∏ –ø–æ 5...
üì¶ –ë–∞—Ç—á 1/21: –æ–±—Ä–∞–±–æ—Ç–∫–∞ 5 —É—Å—Ç—Ä–æ–π—Å—Ç–≤...
‚úÖ –ë–∞—Ç—á 1/21 –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ 2500ms (500ms –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)
```

### –ú–µ—Ç—Ä–∏–∫–∏ –≤ –ë–î:
```sql
SELECT * FROM starline_metrics 
WHERE timestamp > NOW() - INTERVAL '1 hour'
ORDER BY timestamp DESC
LIMIT 1;
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:**
- `batch_size`: 5
- `parallel_mode`: true
- `total_duration_ms`: ~25000-30000 (–≤–º–µ—Å—Ç–æ 100000)
- `avg_device_duration_ms`: ~300-500 (–≤–º–µ—Å—Ç–æ 900-1000)

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–æ–∂–¥–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è workflow** (–∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã)
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏** —á–µ—Ä–µ–∑ `/starline/metrics`
3. **–ü—Ä–∏ —É—Å–ø–µ—Ö–µ:** —É–≤–µ–ª–∏—á–∏—Ç—å `STARLINE_PARALLEL_BATCH_SIZE` –¥–æ 10

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –ü—Ä–æ–∫—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–¢–û–õ–¨–ö–û –¥–ª—è –ª–æ–≥–∏–Ω–∞**, –∑–∞—Ç–µ–º –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç **–ë–ï–ó –ø—Ä–æ–∫—Å–∏** (–±—ã—Å—Ç—Ä–æ)
- Rate limiting: 5 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `STARLINE_MAX_REQUESTS_PER_SECOND`)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ. –û–∂–∏–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.

