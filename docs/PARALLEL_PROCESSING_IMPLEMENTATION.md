# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ Starline —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–î–∞—Ç–∞:** 2025-11-13  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –≠—Ç–∞–ø 1-2 –∑–∞–≤–µ—Ä—à–µ–Ω—ã, –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

---

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –≠—Ç–∞–ø 1: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `STARLINE_PARALLEL_BATCH_SIZE`
- ‚úÖ –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é = 1 (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞, –∫–∞–∫ —Ä–∞–Ω—å—à–µ)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π 1-20

### –≠—Ç–∞–ø 2: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- ‚úÖ –ú–µ—Ç–æ–¥ `processDeviceSafe()` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–¥–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞—Ç—á–∞–º–∏ —á–µ—Ä–µ–∑ `Promise.allSettled()`
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–∏—Å–∞–Ω–∏—è)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–æ–±—â–µ–µ –≤—Ä–µ–º—è, –≤—Ä–µ–º—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –≤—Ä–µ–º—è –Ω–∞ –±–∞—Ç—á)
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `logger` –≤–º–µ—Å—Ç–æ `console.log`

---

## üîß –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –í–∫–ª—é—á–µ–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**1. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ, –≤ `.env` —Ñ–∞–π–ª–µ:**
```bash
# –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (1 = –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è, 5-10 = –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è)
STARLINE_PARALLEL_BATCH_SIZE=5
```

**2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å API:**
```bash
pm2 restart jarvis-api --update-env
```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

- **1** - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (—Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±, –±–µ–∑–æ–ø–∞—Å–Ω–æ)
- **5** - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ 5 —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—á–∞–ª–∞)
- **10** - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ 10 —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞)

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–∏ batchSize = 1 (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è):
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: ~100+ —Å–µ–∫—É–Ω–¥ –¥–ª—è 105 —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ~1 —Å–µ–∫—É–Ω–¥–∞

### –ü—Ä–∏ batchSize = 5 (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è):
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: ~25-30 —Å–µ–∫—É–Ω–¥ –¥–ª—è 105 —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ~0.3-0.5 —Å–µ–∫—É–Ω–¥—ã (–≤ –±–∞—Ç—á–µ)

### –ü—Ä–∏ batchSize = 10 (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è):
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: ~15-20 —Å–µ–∫—É–Ω–¥ –¥–ª—è 105 —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ~0.2-0.3 —Å–µ–∫—É–Ω–¥—ã (–≤ –±–∞—Ç—á–µ)

---

## üß™ –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å batchSize = 5

1. **–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```bash
   cd /root/geodrive_n8n-agents
   git pull
   npm run build
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å batchSize = 5 –≤ .env:**
   ```bash
   echo "STARLINE_PARALLEL_BATCH_SIZE=5" >> .env
   ```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å API:**
   ```bash
   pm2 restart jarvis-api --update-env
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   ```bash
   pm2 logs jarvis-api --lines 50
   ```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç—å workflow –≤—Ä—É—á–Ω—É—é –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
   - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å—Å—è
   - –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è "–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞" –∏ "–ë–∞—Ç—á X/Y"
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –¥–æ–ª–∂–Ω–æ –æ—Å—Ç–∞—Ç—å—Å—è –ø—Ä–µ–∂–Ω–∏–º

### –≠—Ç–∞–ø 4: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–æ batchSize = 10

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Å batchSize = 5:
1. –£–≤–µ–ª–∏—á–∏—Ç—å `STARLINE_PARALLEL_BATCH_SIZE=10`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å API
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ü—Ä–∏ `STARLINE_PARALLEL_BATCH_SIZE=1` —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)

2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Promise.allSettled()` - –æ—à–∏–±–∫–∞ –æ–¥–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Å—Ç–∞–ª—å–Ω—ã—Ö

3. **–ü–µ—Ä–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:** –í—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–∏—Å–∞–Ω–∏—è (–∫–∞–∫ –±—ã–ª–æ —Ä–∞–Ω—å—à–µ)

4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –ª–æ–≥–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## üìù –õ–æ–≥–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ –ª–æ–≥–∞—Ö –±—É–¥—É—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:

```
üìç –ù–∞—á–∏–Ω–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ GPS –¥–∞–Ω–Ω—ã—Ö (—Ä–µ–∂–∏–º: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π, –±–∞—Ç—á 5)...
üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: ...
‚úÖ ...: —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ 104 —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –±–∞—Ç—á–∞–º–∏ –ø–æ 5...
üì¶ –ë–∞—Ç—á 1/21: –æ–±—Ä–∞–±–æ—Ç–∫–∞ 5 —É—Å—Ç—Ä–æ–π—Å—Ç–≤...
‚úÖ –ë–∞—Ç—á 1/21 –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ 2500ms (500ms –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)
üì¶ –ë–∞—Ç—á 2/21: –æ–±—Ä–∞–±–æ—Ç–∫–∞ 5 —É—Å—Ç—Ä–æ–π—Å—Ç–≤...
...
üìä –ò—Ç–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ: 105 –∏–∑ 105 –∑–∞ 25.3—Å (241ms –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)
```

---

## üîÑ –û—Ç–∫–∞—Ç –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã, –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ:

```bash
# –í .env —Ñ–∞–π–ª–µ
STARLINE_PARALLEL_BATCH_SIZE=1

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å API
pm2 restart jarvis-api --update-env
```

---

**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å batchSize = 5

