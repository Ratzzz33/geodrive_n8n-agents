# ‚úÖ –°–≤—è–∑—å –º–∞—à–∏–Ω —Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏/–∏–Ω–≤–µ—Å—Ç–æ—Ä–∞–º–∏ - –ì–û–¢–û–í–û

**–î–∞—Ç–∞:** 2025-11-14  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

---

## üìä –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–í—Å–µ–≥–æ –º–∞—à–∏–Ω:** 136
- **–° –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º:** 7 (5%)
- **–ë–µ–∑ –ø–∞—Ä—Ç–Ω–µ—Ä–∞:** 129 (95%)
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤:** 4

---

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö ‚úÖ
- –ù–∞–π–¥–µ–Ω–æ **6 –º–∞—à–∏–Ω** —Å `investor_id` –≤ –ø–æ–ª–µ `data` (JSONB)
- –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã **4 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö** `investor_id`: **739**, **750**, **769**, **777**
- –¢–æ–ª—å–∫–æ **1 –º–∞—à–∏–Ω–∞** –∏–º–µ–ª–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –ø–æ–ª–µ `investor_id` –≤ –∫–æ–ª–æ–Ω–∫–µ

### 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚úÖ
- –û–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–ª–µ `investor_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `cars` –∏–∑ `data` –ø–æ–ª—è
- **6 –º–∞—à–∏–Ω** –ø–æ–ª—É—á–∏–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π `investor_id` –≤ –∫–æ–ª–æ–Ω–∫–µ
- –¢–µ–ø–µ—Ä—å **7 –º–∞—à–∏–Ω** –∏–∑ 136 –∏–º–µ—é—Ç —Å–≤—è–∑—å —Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏

### 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î ‚úÖ
- ‚úÖ –ü–æ–ª–µ `investor_id` (BIGINT) –≤ —Ç–∞–±–ª–∏—Ü–µ `cars`
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `rentprog_employees` —Å –ø–æ–ª–µ–º `role` (–≤–∫–ª—é—á–∞—è `'partner'`)
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `external_refs` –¥–ª—è —Å–≤—è–∑–∏ –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º

### 4. –°–æ–∑–¥–∞–Ω–Ω—ã–µ VIEW ‚úÖ

#### `cars_with_investors`
–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—à–∏–Ω–∞—Ö —Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏:
- ID, –Ω–æ–º–µ—Ä, –º–æ–¥–µ–ª—å, –≥–æ–¥ –º–∞—à–∏–Ω—ã
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª–∏–∞–ª–µ
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ä—Ç–Ω–µ—Ä–µ (–∏–º—è, email, —Ä–æ–ª—å)

#### `investor_statistics`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω
- –§–∏–ª–∏–∞–ª—ã
- –ù–æ–º–µ—Ä–∞ –º–∞—à–∏–Ω
- –°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–±–µ–≥
- –ì–æ–¥–∞ –≤—ã–ø—É—Å–∫–∞

---

## üìã –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—à–∏–Ω –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º

### –ü–∞—Ä—Ç–Ω–µ—Ä ID 739 (4 –º–∞—à–∏–Ω—ã)
**–§–∏–ª–∏–∞–ª—ã:** Batumi, Tbilisi  
**–ú–∞—à–∏–Ω—ã:**
- `BB681BF` - Volkswagen Tiguan (2014) [batumi]
- `FK288FF` - Porsche Macan S (2015) [tbilisi]
- `GG134HG` - Toyota Prius (2013) [tbilisi]
- `MM207LM` - Mazda 3 (2015) [tbilisi]

**–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–±–µ–≥:** 189,443 –∫–º

---

### –ü–∞—Ä—Ç–Ω–µ—Ä ID 750 (1 –º–∞—à–∏–Ω–∞)
**–§–∏–ª–∏–∞–ª:** Kutaisi  
**–ú–∞—à–∏–Ω—ã:**
- `XX950DX` - Audi Q7 (2018) [kutaisi]

**–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–±–µ–≥:** 165,501 –∫–º

---

### –ü–∞—Ä—Ç–Ω–µ—Ä ID 769 (1 –º–∞—à–∏–Ω–∞)
**–§–∏–ª–∏–∞–ª:** Tbilisi  
**–ú–∞—à–∏–Ω—ã:**
- `UN522UN` - Buick Encore (2017) [tbilisi]

**–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–±–µ–≥:** 172,189 –∫–º

---

### –ü–∞—Ä—Ç–Ω–µ—Ä ID 777 (1 –º–∞—à–∏–Ω–∞)
**–§–∏–ª–∏–∞–ª:** Tbilisi  
**–ú–∞—à–∏–Ω—ã:**
- `PJ756PJ` - Hyundai Tucson Silver (2019) [tbilisi]

**–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–±–µ–≥:** 34,413 –∫–º

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### SQL –∑–∞–ø—Ä–æ—Å—ã

#### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –º–∞—à–∏–Ω—ã –ø–∞—Ä—Ç–Ω–µ—Ä–∞ 739:
```sql
SELECT * FROM cars_with_investors WHERE investor_id = 739;
```

#### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º:
```sql
SELECT * FROM investor_statistics;
```

#### –ü–æ–ª—É—á–∏—Ç—å –º–∞—à–∏–Ω—ã –±–µ–∑ –ø–∞—Ä—Ç–Ω–µ—Ä–∞:
```sql
SELECT plate, model, branch_code 
FROM cars 
WHERE investor_id IS NULL;
```

#### –ü–æ–ª—É—á–∏—Ç—å –º–∞—à–∏–Ω—ã –ø–æ —Ñ–∏–ª–∏–∞–ª–∞–º –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞:
```sql
SELECT branch_code, COUNT(*) as cars_count
FROM cars_with_investors 
WHERE investor_id = 739 
GROUP BY branch_code;
```

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 1. –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞—Ö
- –ü–∞—Ä—Ç–Ω–µ—Ä—ã —Å ID 739, 750, 769, 777 **–ù–ï –Ω–∞–π–¥–µ–Ω—ã** –≤ RentProg API `/users`
- –í–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —Å—Ç–∞—Ä—ã–µ/—É–¥–∞–ª–µ–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
- –í VIEW –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"

### 2. –ù–µ—Ç Foreign Key —Å–≤—è–∑–∏
- –ü–æ–ª–µ `investor_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `cars` **–Ω–µ –∏–º–µ–µ—Ç FK** –Ω–∞ `rentprog_employees`
- –≠—Ç–æ —á–∏—Å–ª–æ–≤–æ–π ID –∏–∑ RentProg, –Ω–æ —Å–≤—è–∑—å –ª–æ–≥–∏—á–µ—Å–∫–∞—è

### 3. –ù–µ—Ç external_refs –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- –í —Ç–∞–±–ª–∏—Ü–µ `external_refs` –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π —Ç–∏–ø–∞ `'investor'`
- –°–≤—è–∑—å –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–µ –ø–æ–ª–µ `investor_id`

---

## üîß –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

### 1. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞—Ö –≤—Ä—É—á–Ω—É—é
```sql
-- –í—Å—Ç–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞—Ä—Ç–Ω–µ—Ä–µ –≤—Ä—É—á–Ω—É—é
INSERT INTO rentprog_employees (
  id, rentprog_id, name, role, active, created_at, updated_at
)
VALUES (
  gen_random_uuid(),
  '739',
  '–ò–º—è –ü–∞—Ä—Ç–Ω–µ—Ä–∞',
  'partner',
  true,
  NOW(),
  NOW()
);
```

### 2. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `investors`
–ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–µ—Ç –≤ RentProg, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É:
```sql
CREATE TABLE investors (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  rentprog_investor_id BIGINT UNIQUE,
  name TEXT,
  email TEXT,
  phone TEXT,
  contract_number TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

### 3. –î–æ–±–∞–≤–∏—Ç—å FK —Å–≤—è–∑—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```sql
-- –î–æ–±–∞–≤–∏—Ç—å FK –∫ rentprog_employees
ALTER TABLE cars 
  ADD CONSTRAINT fk_cars_investor 
  FOREIGN KEY (investor_id) 
  REFERENCES rentprog_employees(rentprog_id::bigint)
  ON DELETE SET NULL;
```

---

## üìÅ –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

### –°–∫—Ä–∏–ø—Ç—ã
- `setup/find_and_link_investors.mjs` - —Å–∫—Ä–∏–ø—Ç —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –º–∞—à–∏–Ω —Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏
- `setup/create_cars_investors_view.sql` - —Å–æ–∑–¥–∞–Ω–∏–µ VIEW

### VIEW
- `cars_with_investors` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—à–∏–Ω–∞—Ö —Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏
- `investor_statistics` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°–≤—è–∑—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!** 

–¢–µ–ø–µ—Ä—å –≤ –ë–î –µ—Å—Ç—å:
- ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –ø–æ–ª–µ `investor_id` –¥–ª—è 7 –º–∞—à–∏–Ω
- ‚úÖ VIEW –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º

**–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è:**
- üìä –û—Ç—á–µ—Ç–æ–≤ –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º
- üí∞ –†–∞—Å—á–µ—Ç–∞ –¥–æ—Ö–æ–¥–æ–≤ –ø–æ –º–∞—à–∏–Ω–∞–º –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- üìà –ê–Ω–∞–ª–∏–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏—Ö –º–∞—à–∏–Ω
- üöó –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∫–æ–º –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏—Ö –∞–≤—Ç–æ

---

**–ê–≤—Ç–æ—Ä:** Claude AI  
**–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2025-11-14  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~15 –º–∏–Ω—É—Ç

