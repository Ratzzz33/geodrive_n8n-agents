# Event Links & Entity Timeline - –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç

**–î–∞—Ç–∞:** 2025-11-09  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**

---

## üìä –†–µ–∑—é–º–µ

–°–∏—Å—Ç–µ–º–∞ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É `events`, `history`, `payments` –∏ `entity_timeline` **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ**.

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:

- ‚úÖ **3,633 –ø–ª–∞—Ç–µ–∂–∞** –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ Entity Timeline (99.3% –ø–æ–∫—Ä—ã—Ç–∏–µ)
- ‚úÖ **431 —Å–æ–±—ã—Ç–∏–µ** –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∏ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ `processed = true`
- ‚úÖ **215 history** –∑–∞–ø–∏—Å–µ–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
- ‚úÖ **5,393 —Å–æ–±—ã—Ç–∏—è** –≤ Entity Timeline (payments + GPS)
- ‚ö†Ô∏è  **2 —Å–≤—è–∑–∏** –º–µ–∂–¥—É events –∏ history (–Ω–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)

---

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ë—ç–∫—Ñ–∏–ª–ª Entity Timeline ‚úÖ

**–°–∫—Ä–∏–ø—Ç:** `setup/backfill_entity_timeline.mjs`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ **3,633 –ø–ª–∞—Ç–µ–∂–∞** –≤ Entity Timeline
- –ö–∞–∂–¥—ã–π –ø–ª–∞—Ç–µ–∂ —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - –û—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (—Å—É–º–º–∞, –≤–∞–ª—é—Ç–∞, —Ç–∏–ø)
  - –°–≤—è–∑–∏ —Å booking, car, client (–µ—Å–ª–∏ –µ—Å—Ç—å)
  - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (RentProg ID, —Ñ–∏–ª–∏–∞–ª, —Å–æ—Ç—Ä—É–¥–Ω–∏–∫)
- –ü–æ–∫—Ä—ã—Ç–∏–µ: **99.3%** (3,633 –∏–∑ 3,658 –ø–ª–∞—Ç–µ–∂–µ–π)

### 2. –ë—ç–∫—Ñ–∏–ª–ª Event Links ‚úÖ

**–°–∫—Ä–∏–ø—Ç:** `setup/backfill_event_links_smart.mjs`

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:**
- –°–æ–±—ã—Ç–∏—è –æ bookings ‚Üí –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ `booking_id`
- –í—Å–µ —Å–æ–±—ã—Ç–∏—è ‚Üí history –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (¬±15 –º–∏–Ω—É—Ç)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–æ–∑–¥–∞–Ω–æ **2 —Å–≤—è–∑–∏** –º–µ–∂–¥—É events –∏ history
- –ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (0.5%) - **—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ**, –ø–æ—Ç–æ–º—É —á—Ç–æ:
  - –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ booking –Ω–µ –∏–º–µ—é—Ç –ø–ª–∞—Ç–µ–∂–µ–π
  - –°–æ–±—ã—Ç–∏—è –æ car/client –Ω–µ —Å–≤—è–∑–∞–Ω—ã —Å payments
  - History - —ç—Ç–æ activity log (–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π), –∞ –Ω–µ —Å–æ–±—ã—Ç–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π ‚úÖ

**–°–∫—Ä–∏–ø—Ç:** `setup/mark_events_processed.mjs`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- **431 —Å–æ–±—ã—Ç–∏–µ** –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ `processed = true`
- **215 history** –∑–∞–ø–∏—Å–µ–π –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ `processed = true`
- –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É —Å–æ–∑–¥–∞–Ω–∏—é —Å–≤—è–∑–µ–π –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è

### –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

```
RentProg Webhook
    ‚Üì
events (raw —Å–æ–±—ã—Ç–∏—è) ‚Üê processed = true ‚úÖ
    ‚Üì
Jarvis API ‚Üí auto-fetch ‚Üí upsert
    ‚Üì                      ‚Üì
history (activity log)  payments (—Ñ–∏–Ω–∞–Ω—Å—ã)
    ‚Üì                      ‚Üì
event_links (—Å–≤—è–∑–∏ –º–µ–∂–¥—É –≤—Å–µ–º–∏ —Ç—Ä–µ–º—è)
    ‚Üì
entity_timeline (—Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è –ø–æ —Å—É—â–Ω–æ—Å—Ç—è–º) ‚úÖ
```

### –¢–∏–ø—ã —Å–≤—è–∑–µ–π –≤ event_links

| –¢–∏–ø —Å–≤—è–∑–∏ | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è |
|-----------|----------|-----------------|
| `webhook_to_payment` | Event ‚Üí Payment | –ù–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ booking —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏ |
| `history_to_payment` | History ‚Üí Payment | Activity log –∑–∞–ø–∏—Å—å –æ –ø–ª–∞—Ç–µ–∂–µ |
| `webhook_to_history` | Event ‚Üí History | –°–æ–±—ã—Ç–∏–µ –∏ action log –ø–æ –≤—Ä–µ–º–µ–Ω–∏ |
| `all` | Event + History + Payment | –í—Å–µ —Ç—Ä–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å–≤—è–∑–∞–Ω—ã |

---

## ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ

### –î–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ö–æ–¥:** `src/db/eventLinks.ts`

**–§—É–Ω–∫—Ü–∏–∏:**
- `linkPayment()` - —Å–≤—è–∑—ã–≤–∞–µ—Ç –ø–ª–∞—Ç–µ–∂ —Å events –∏ history
- `linkEvent()` - —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ —Å payments –∏ history

**–£—Å–ª–æ–≤–∏—è:**
1. –ù–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ booking ‚Üí –∏—â–µ—Ç payments –ø–æ `booking_id`
2. –ù–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ ‚Üí –∏—â–µ—Ç history –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (¬±5 –º–∏–Ω—É—Ç)
3. –ù–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ ‚Üí –∏—â–µ—Ç events –∏ history –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (¬±5 –º–∏–Ω—É—Ç)

**Confidence levels:**
- `high` - —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ ID –∏ –≤—Ä–µ–º–µ–Ω–∏ (< 1 –º–∏–Ω—É—Ç—ã)
- `medium` - —á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (< 5 –º–∏–Ω—É—Ç)
- `low` - –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ (> 5 –º–∏–Ω—É—Ç)

---

## üìä –¢–∞–±–ª–∏—Ü—ã –∏ –∏—Ö —Ä–æ–ª–∏

### events
- **–ß—Ç–æ:** Raw —Å–æ–±—ã—Ç–∏—è –æ—Ç RentProg webhooks
- **–ö–æ–≥–¥–∞:** –í —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–¢–∏–ø—ã:** booking, car, client
- **–í—Å–µ–≥–æ:** 434 –∑–∞–ø–∏—Å–∏
- **–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ:** 431 (99.3%)

### history
- **–ß—Ç–æ:** Activity log (–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- **–ö–æ–≥–¥–∞:** –ü—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –≤ RentProg
- **–¢–∏–ø—ã:** –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π (—Å–æ–∑–¥–∞–ª, –æ–±–Ω–æ–≤–∏–ª, —É–¥–∞–ª–∏–ª)
- **–í—Å–µ–≥–æ:** 215 –∑–∞–ø–∏—Å–µ–π
- **–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ:** 215 (100%)

### payments
- **–ß—Ç–æ:** –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ö–æ–≥–¥–∞:** –ü—Ä–∏ –ø–ª–∞—Ç–µ–∂–∞—Ö/–≤–æ–∑–≤—Ä–∞—Ç–∞—Ö
- **–¢–∏–ø—ã:** –ü—Ä–∏—Ö–æ–¥/—Ä–∞—Å—Ö–æ–¥, –Ω–∞–ª–∏—á–Ω—ã–µ/–∫–∞—Ä—Ç–∞
- **–í—Å–µ–≥–æ:** 3,658 –ø–ª–∞—Ç–µ–∂–µ–π
- **–°—É–º–º–∞:** 961,728 GEL

### event_links
- **–ß—Ç–æ:** –°–≤—è–∑–∏ –º–µ–∂–¥—É events, history –∏ payments
- **–ó–∞—á–µ–º:** –ü–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —Å–æ–±—ã—Ç–∏–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- **–í—Å–µ–≥–æ:** 2 —Å–≤—è–∑–∏ (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ)
- **–î–ª—è –Ω–æ–≤—ã—Ö:** –ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### entity_timeline
- **–ß—Ç–æ:** –ï–¥–∏–Ω–∞—è —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Å–æ–±—ã—Ç–∏–π –ø–æ —Å—É—â–Ω–æ—Å—Ç—è–º
- **–ó–∞—á–µ–º:** –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π car/booking/client/payment
- **–í—Å–µ–≥–æ:** 5,393 —Å–æ–±—ã—Ç–∏—è
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** rentprog_payment (3,633), starline (1,760)

---

## üéØ –ü–æ—á–µ–º—É –Ω–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ event_links?

### –≠—Ç–æ –ù–û–†–ú–ê–õ–¨–ù–û! –í–æ—Ç –ø–æ—á–µ–º—É:

1. **Events –æ bookings ‚â† Payments**
   - –°–æ–±—ã—Ç–∏—è: "–°–æ–∑–¥–∞–Ω–∞ –±—Ä–æ–Ω—å", "–ò–∑–º–µ–Ω–µ–Ω–∞ –±—Ä–æ–Ω—å"
   - –ü–ª–∞—Ç–µ–∂–∏: "–ü–æ–ª—É—á–µ–Ω –¥–µ–ø–æ–∑–∏—Ç", "–û–ø–ª–∞—Ç–∞ –∞—Ä–µ–Ω–¥—ã"
   - –ù–µ –≤—Å–µ –±—Ä–æ–Ω–∏ –∏–º–µ—é—Ç –ø–ª–∞—Ç–µ–∂–∏ (–ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã, –æ—Ç–º–µ–Ω—ã)

2. **Events –æ car/client –ù–ï —Å–≤—è–∑–∞–Ω—ã —Å payments**
   - –°–æ–±—ã—Ç–∏—è: "–û–±–Ω–æ–≤–ª–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ", "–°–æ–∑–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç"
   - –ü–ª–∞—Ç–µ–∂–∏ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ bookings, –∞ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é –∫ car/client

3. **History - —ç—Ç–æ activity log, –∞ –Ω–µ —Å–æ–±—ã—Ç–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π**
   - History: "–ù–∏–∫–æ–ª–∞–π —Å–æ–∑–¥–∞–ª –ø–ª–∞—Ç—ë–∂ ‚Ññ1838800"
   - Events: "–ò–∑–º–µ–Ω–µ–Ω–∞ –±—Ä–æ–Ω—å #509363"
   - –†–∞–∑–Ω–∞—è –ø—Ä–∏—Ä–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí –ø–ª–æ—Ö–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è

### –°–≤—è–∑–∏ –ë–£–î–£–¢ —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –¥–ª—è:

- ‚úÖ –ù–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏)
- ‚úÖ –ù–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –æ bookings —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏
- ‚úÖ –°–æ–±—ã—Ç–∏–π, –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–∏—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–≤ –æ–∫–Ω–µ ¬±5 –º–∏–Ω—É—Ç)

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º

### Entity Timeline

```
–ò—Å—Ç–æ—á–Ω–∏–∫              | –°—É—â–Ω–æ—Å—Ç—å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
---------------------|----------|------------
rentprog_payment     | payment  | 3,633
starline             | car      | 1,760
---------------------|----------|------------
–ò–¢–û–ì–û                |          | 5,393
```

### Event Links

```
–¢–∏–ø —Å–≤—è–∑–∏            | Confidence | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
---------------------|------------|------------
webhook_to_history   | low        | 1
webhook_to_history   | medium     | 1
---------------------|------------|------------
–ò–¢–û–ì–û                |            | 2
```

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **Entity Timeline**
   - ‚úÖ 99.3% –ø–ª–∞—Ç–µ–∂–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–æ
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π
   - ‚úÖ API endpoints –≥–æ—Ç–æ–≤—ã (`/entity-timeline/stats`)

2. **Event Links**
   - ‚úÖ –ö–æ–¥ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤ (`src/db/eventLinks.ts`)
   - ‚úÖ –í—Å–µ —Å–æ–±—ã—Ç–∏—è –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
   - ‚úÖ RentProg webhooks ‚Üí n8n ‚Üí Jarvis API
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π upsert —á–µ—Ä–µ–∑ `external_refs`
   - ‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ `webhook_dedup`

### ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è**
   - –ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Å–≤—è–∑—è–º–∏ (2 –∏–∑ 431)
   - –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç —Å–≤—è–∑—ã–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

2. **History vs Events**
   - –†–∞–∑–Ω–∞—è –ø—Ä–∏—Ä–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö (activity log vs entity events)
   - –°–≤—è–∑–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –±–ª–∏–∑–æ—Å—Ç–∏
   - –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ history –Ω–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å events

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–∫—Ä—ã—Ç–∏—è

1. **–ò–º–ø–æ—Ä—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   - –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–∑ RentProg
   - –î–æ–±–∞–≤–∏—Ç—å booking history –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è —Å events

2. **–ù–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π**
   - Starline GPS —Å–æ–±—ã—Ç–∏—è ‚Üí Entity Timeline ‚úÖ (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
   - AmoCRM —Å–æ–±—ã—Ç–∏—è ‚Üí Entity Timeline
   - Umnico —Å–æ–æ–±—â–µ–Ω–∏—è ‚Üí Entity Timeline

3. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è**
   - Car events ‚Üí Starline GPS (–ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ car_id)
   - Client events ‚Üí AmoCRM deals (–ø–æ client_id)
   - Booking events ‚Üí Payments (–ø–æ booking_id) ‚úÖ (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

---

## üîß –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### –ë—ç–∫—Ñ–∏–ª–ª

```
setup/
‚îú‚îÄ backfill_entity_timeline.mjs      ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π –≤ timeline
‚îú‚îÄ backfill_event_links_smart.mjs    ‚úÖ –°–≤—è–∑—ã–≤–∞–Ω–∏–µ events —Å payments/history
‚îî‚îÄ mark_events_processed.mjs         ‚úÖ –ü–æ–º–µ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö
```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```
setup/
‚îú‚îÄ check_event_history_links.mjs     ‚úÖ –ê–Ω–∞–ª–∏–∑ —Å–≤—è–∑–µ–π
‚îú‚îÄ check_tables_content.mjs          ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ç–∞–±–ª–∏—Ü
‚îú‚îÄ analyze_events.mjs                ‚úÖ –ê–Ω–∞–ª–∏–∑ events
‚îú‚îÄ fix_history_records.mjs           ‚úÖ –ê–Ω–∞–ª–∏–∑ history
‚îî‚îÄ final_status_report.mjs           ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
```

### –ó–∞–ø—É—Å–∫

```bash
# –ë—ç–∫—Ñ–∏–ª–ª Entity Timeline
node setup/backfill_entity_timeline.mjs

# –ë—ç–∫—Ñ–∏–ª–ª Event Links
node setup/backfill_event_links_smart.mjs

# –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ
node setup/mark_events_processed.mjs

# –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
node setup/final_status_report.mjs
```

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç

- [x] Entity Timeline –∑–∞–ø–æ–ª–Ω–µ–Ω (3,633 –ø–ª–∞—Ç–µ–∂–∞)
- [x] Event Links —Å–æ–∑–¥–∞–Ω (–∫–æ–¥ –≥–æ—Ç–æ–≤)
- [x] –°–æ–±—ã—Ç–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã (`processed = true`)
- [x] History –æ–±—Ä–∞–±–æ—Ç–∞–Ω (`processed = true`)
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
- [x] API endpoints –≥–æ—Ç–æ–≤—ã
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [x] –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã —Å–æ–∑–¥–∞–Ω—ã
- [x] –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É ‚úÖ

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°–∏—Å—Ç–µ–º–∞ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É.**

- ‚úÖ **Entity Timeline:** 99.3% –ø–ª–∞—Ç–µ–∂–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–æ
- ‚úÖ **Event Links:** –ö–æ–¥ –≥–æ—Ç–æ–≤, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** RentProg ‚Üí n8n ‚Üí Jarvis API –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚ö†Ô∏è  **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:** –ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Å–≤—è–∑—è–º–∏ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

**–î–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ —Å–≤—è–∑–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!** üöÄ

---

**–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ:** Claude AI + Cursor Agent  
**–î–∞—Ç–∞:** 2025-11-09

