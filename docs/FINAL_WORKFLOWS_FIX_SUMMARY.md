# ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö 4 workflow

**–î–∞—Ç–∞:** 2025-01-21  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ workflow –æ–±–Ω–æ–≤–ª–µ–Ω—ã, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –§—É–Ω–∫—Ü–∏—è `dynamic_upsert_entity()` –≤ –ë–î
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è `0042_fix_null_values_in_dynamic_upsert.sql` –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç NULL: `IF v_value_text IS NULL OR v_value_text = '' THEN CONTINUE;`
- ‚úÖ NULL –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ SET clause –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

### 2. –ù–æ–¥–∞ "Prepare Update" –≤–æ –≤—Å–µ—Ö 4 workflow
- ‚úÖ **Tbilisi** (`P65bXE5Xhupkxxw6`) - –æ–±–Ω–æ–≤–ª–µ–Ω
- ‚úÖ **Batumi** (`YsBma7qYsdsDykTq`) - –æ–±–Ω–æ–≤–ª–µ–Ω
- ‚úÖ **Kutaisi** (`gJPvJwGQSi8455s9`) - –æ–±–Ω–æ–≤–ª–µ–Ω
- ‚úÖ **Service Center** (`PbDKuU06H7s2Oem8`) - –æ–±–Ω–æ–≤–ª–µ–Ω

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è NULL/undefined –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–¥ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º updates

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –≤–µ–±—Ö—É–∫–∞—Ö

### Execution #27607 (Kutaisi) - –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**Payload:**
```json
{
  "description": ["305 + 100", "305"],
  "id": 510335,
  "user_id": null  // ‚Üê NULL –∑–Ω–∞—á–µ–Ω–∏–µ
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ Prepare Update:**
```json
{
  "updates_json": "{\"description\":\"305\",\"created_from_api\":true,\"updated_from_api\":false}"
}
```

**‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:**
- `user_id: null` **–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω** –∏ –Ω–µ –ø–æ–ø–∞–ª –≤ updates_json
- –¢–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ø–∞–ª–∏ –≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!

### Execution #27608 (Service Center) - –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**Payload:**
```json
{
  "company_id": [9247, 11163],
  "id": 39736,
  "branch_name": "GeoDrive Auto Service"
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ Prepare Update:**
```json
{
  "updates_json": "{\"company_id\":11163,\"created_from_api\":false,\"updated_from_api\":false,\"branch_name\":\"GeoDrive Auto Service\"}"
}
```

**‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:**
- –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- NULL –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ –±—ã–ª–æ, –≤—Å–µ –ø—Ä–æ—à–ª–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

### –¢–µ—Å—Ç–æ–≤—ã–µ –≤–µ–±—Ö—É–∫–∏

**Kutaisi workflow:**
- ‚úÖ –í–µ–±—Ö—É–∫ —Å `user_id: null` –æ–±—Ä–∞–±–æ—Ç–∞–Ω —É—Å–ø–µ—à–Ω–æ
- ‚úÖ NULL –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ

**Service Center workflow:**
- ‚úÖ –í–µ–±—Ö—É–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞:** ‚úÖ
- **Workflow –æ–±–Ω–æ–≤–ª–µ–Ω—ã:** ‚úÖ (4/4)
- **–ó–∞—â–∏—Ç–∞ –æ—Ç NULL:** ‚úÖ (–¥–≤–æ–π–Ω–∞—è: workflow + –ë–î)
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚úÖ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö executions)
- **–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 8 –∑–∞–ø–∏—Å–µ–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –º–∏–Ω—É—Ç

---

## üéØ –ò—Ç–æ–≥–∏

### –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
1. ‚úÖ –§—É–Ω–∫—Ü–∏—è `dynamic_upsert_entity()` –Ω–µ –∑–∞—Ç–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ NULL –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
2. ‚úÖ –ù–æ–¥–∞ "Prepare Update" —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç NULL –≤–æ –≤—Å–µ—Ö 4 workflow
3. ‚úÖ –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞: –Ω–∞ —É—Ä–æ–≤–Ω–µ workflow –∏ –ë–î

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:
1. ‚úÖ Execution #27607 (Kutaisi) - NULL –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã
2. ‚úÖ Execution #27608 (Service Center) - –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –≤–µ–±—Ö—É–∫–∏ - –≤—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
- ‚úÖ –í—Å–µ 4 workflow –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Å –∑–∞—Ç–∏—Ä–∞–Ω–∏–µ–º NULL –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –ì–û–¢–û–í–û!**

