# –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≤–µ–±—Ö—É–∫–æ–≤ RentProg

**–î–∞—Ç–∞:** 2025-01-15  
**–î–ª—è:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ RentProg

---

## üéØ –û–¥–∏–Ω –∞–¥—Ä–µ—Å –¥–ª—è –≤—Å–µ—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –µ–¥–∏–Ω—ã–π URL –¥–ª—è –≤—Å–µ—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤ (Tbilisi, Batumi, Kutaisi, Rustavi):

```
https://webhook.rentflow.rentals
```

---

## üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≤ RentProg

### –®–∞–≥ 1: –í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω–∫—É RentProg
- URL: [https://rentprog.net](https://rentprog.net)
- –í–æ–π–¥–∏—Ç–µ —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –®–∞–≥ 2: –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–µ–±—Ö—É–∫–æ–≤
- –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª: **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏" ‚Üí "Webhooks"** (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π)
- –ò–ª–∏ —Ä–∞–∑–¥–µ–ª **"API"** ‚Üí **"Webhooks"**

### –®–∞–≥ 3: –î–æ–±–∞–≤—å—Ç–µ/–æ–±–Ω–æ–≤–∏—Ç–µ URL –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞

**–î–ª—è —Ñ–∏–ª–∏–∞–ª–∞ Tbilisi:**
- URL –≤–µ–±—Ö—É–∫–∞: `https://webhook.rentflow.rentals`
- –ú–µ—Ç–æ–¥: `POST`
- –ê–∫—Ç–∏–≤–µ–Ω: ‚úÖ

**–î–ª—è —Ñ–∏–ª–∏–∞–ª–∞ Batumi:**
- URL –≤–µ–±—Ö—É–∫–∞: `https://webhook.rentflow.rentals`
- –ú–µ—Ç–æ–¥: `POST`
- –ê–∫—Ç–∏–≤–µ–Ω: ‚úÖ

**–î–ª—è —Ñ–∏–ª–∏–∞–ª–∞ Kutaisi:**
- URL –≤–µ–±—Ö—É–∫–∞: `https://webhook.rentflow.rentals`
- –ú–µ—Ç–æ–¥: `POST`
- –ê–∫—Ç–∏–≤–µ–Ω: ‚úÖ

**–î–ª—è —Ñ–∏–ª–∏–∞–ª–∞ Rustavi:**
- URL –≤–µ–±—Ö—É–∫–∞: `https://webhook.rentflow.rentals`
- –ú–µ—Ç–æ–¥: `POST`
- –ê–∫—Ç–∏–≤–µ–Ω: ‚úÖ

### –®–∞–≥ 4: –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏

–û—Ç–º–µ—Ç—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã):
- ‚úÖ –ù–æ–≤–∞—è –±—Ä–æ–Ω—å (booking.created)
- ‚úÖ –í—ã–¥–∞—á–∞ –∞–≤—Ç–æ (booking.issue.planned, booking.issued)
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –∞–≤—Ç–æ (booking.return.planned, booking.returned)
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±—Ä–æ–Ω–∏ (booking.updated)
- ‚úÖ –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏ (booking.cancelled)
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ (car.updated, car.moved)
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ (client.updated)
- ‚úÖ –ü–ª–∞—Ç–µ–∂–∏ (payment.created, payment.completed)

### –®–∞–≥ 5: –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ù–∞–∂–º–∏—Ç–µ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"** –∏–ª–∏ **"–ü—Ä–∏–º–µ–Ω–∏—Ç—å"**

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç 1: –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –≤–µ–±—Ö—É–∫ –∏–∑ RentProg
- –ù–∞–π–¥–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç"** –∏–ª–∏ **"Test webhook"**
- RentProg –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
- –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: `{"ok": true, "received": true}`

### –¢–µ—Å—Ç 2: –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
- –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –±—Ä–æ–Ω—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–æ–±—ã—Ç–∏–µ –ø—Ä–∏—à–ª–æ –≤ —Å–∏—Å—Ç–µ–º—É

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ n8n
- –û—Ç–∫—Ä–æ–π—Ç–µ: http://46.224.17.15:5678
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"Executions"**
- –ù–∞–π–¥–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è workflow **"RentProg Webhooks Monitor"**
- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å–ø–µ—à–Ω—ã–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–∑–µ–ª–µ–Ω—ã–µ)

### –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
```sql
-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
SELECT * FROM events ORDER BY ts DESC LIMIT 10;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–∏–ª–∏–∞–ª–∞–º
SELECT branch, COUNT(*) as total, 
       SUM(CASE WHEN ok THEN 1 ELSE 0 END) as success,
       SUM(CASE WHEN processed THEN 1 ELSE 0 END) as processed
FROM events
WHERE ts > NOW() - INTERVAL '1 hour'
GROUP BY branch;
```

---

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "Webhook URL not reachable"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–æ–º–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω:
   ```bash
   curl -I https://webhook.rentflow.rentals
   # –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: HTTP/2 200
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS:
   ```bash
   nslookup webhook.rentflow.rentals
   # –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: 46.224.17.15
   ```

3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL –≤–≤–µ–¥–µ–Ω **–±–µ–∑ —Å–ª—ç—à–∞** –≤ –∫–æ–Ω—Ü–µ:
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: `https://webhook.rentflow.rentals`
   - ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: `https://webhook.rentflow.rentals/`

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Timeout" –∏–ª–∏ "No response"

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ n8n –∑–∞–ø—É—â–µ–Ω:
  ```bash
  curl http://46.224.17.15:5678/health
  # –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: OK
  ```

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Nginx:
  ```bash
  tail -f /var/log/nginx/webhook-access.log
  tail -f /var/log/nginx/webhook-error.log
  ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ–±—ã—Ç–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç, –Ω–æ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –°–æ–±—ã—Ç–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –±–æ–ª–µ–µ 10 –º–∏–Ω—É—Ç
SELECT * FROM events 
WHERE processed = false 
  AND ts < NOW() - INTERVAL '10 minutes'
ORDER BY ts DESC;
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ n8n: http://46.224.17.15:5678
2. –ù–∞–π–¥–∏—Ç–µ workflow **"RentProg Upsert Processor"**
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω **–∞–∫—Ç–∏–≤–µ–Ω** (Active: ON)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ executions –Ω–∞ –æ—à–∏–±–∫–∏

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: [WEBHOOK_URLS_UPDATE.md](./WEBHOOK_URLS_UPDATE.md)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã —á–µ—Ä–µ–∑ –±–æ—Ç: `/status`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ n8n console: http://46.224.17.15:5678

---

## üìå –í–∞–∂–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **–ü—Ä–æ–¥–∞–∫—à–Ω webhook:** https://webhook.rentflow.rentals
- **–¢–µ—Å—Ç–æ–≤—ã–π webhook:** https://geodrive.netlify.app/webhook/rentprog-webhook
- **n8n Console:** http://46.224.17.15:5678
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [README.md](./README.md)
- **–ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç:** [SESSION_REPORT_2025-01-15.md](./SESSION_REPORT_2025-01-15.md)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
**SSL:** ‚úÖ Let's Encrypt (–¥–æ 2026-01-31)  
**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** ‚úÖ n8n executions + PostgreSQL events table

