# Workflow: Restore Cars from RentProg (Scheduled)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –°–æ–∑–¥–∞–Ω  
**Workflow ID:** `TqJ3ZkUWdlRCbaRt`  
**URL:** https://n8n.rentflow.rentals/workflow/TqJ3ZkUWdlRCbaRt

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π workflow –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–∞—à–∏–Ω –∏–∑ RentProg API –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** –ö–∞–∂–¥—ã–µ 3 —á–∞—Å–∞ —Å 8:00 –¥–æ 23:00 (Asia/Tbilisi)
- 8:00, 11:00, 14:00, 17:00, 20:00, 23:00

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

1. **Schedule Trigger** - –∑–∞–ø—É—Å–∫–∞–µ—Ç workflow –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
2. **Call Jarvis API** - –≤—ã–∑—ã–≤–∞–µ—Ç `POST /restore-cars` –Ω–∞ Jarvis API
3. **Format Report** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –∏–∑ –æ—Ç–≤–µ—Ç–∞ API
4. **Send Telegram Alert** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á–µ—Ç –≤ Telegram

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. Jarvis API Endpoint

**Endpoint:** `POST http://46.224.17.15:3000/restore-cars`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç `setup/restore_cars_from_rentprog.mjs` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

**–û—Ç–≤–µ—Ç:**
```json
{
  "ok": true,
  "stats": {
    "totalCars": 126,
    "inserted": 0,
    "updated": 125,
    "skipped": 1
  },
  "branches": [
    {
      "branch": "tbilisi",
      "total": 65,
      "inserted": 0,
      "updated": 65,
      "skipped": 0
    },
    ...
  ],
  "output": "...",
  "timestamp": "2025-11-10T12:00:00.000Z"
}
```

### 2. Telegram Credentials

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ workflow –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã credentials –¥–ª—è Telegram Bot API:
- **Chat ID:** `$env.TELEGRAM_ALERT_CHAT_ID`
- **Bot Token:** –∏–∑ credentials "Telegram Bot API"

### 3. –ê–∫—Ç–∏–≤–∞—Ü–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ workflow –≤ n8n UI
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ credentials –¥–ª—è Telegram
3. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ workflow (–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É)

---

## üìä –§–æ—Ä–º–∞—Ç –æ—Ç—á–µ—Ç–∞ –≤ Telegram

```
üöÄ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–∞—à–∏–Ω –∏–∑ RentProg API

üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –º–∞—à–∏–Ω: 126
–î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤—ã—Ö: 0
–û–±–Ω–æ–≤–ª–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö: 125
–ü—Ä–æ–ø—É—â–µ–Ω–æ (—Ñ–µ–π–∫–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞): 1

üìã –ü–æ —Ñ–∏–ª–∏–∞–ª–∞–º:

Tbilisi:
  –í—Å–µ–≥–æ –º–∞—à–∏–Ω: 65
  –î–æ–±–∞–≤–ª–µ–Ω–æ: 0
  –û–±–Ω–æ–≤–ª–µ–Ω–æ: 65
  –ü—Ä–æ–ø—É—â–µ–Ω–æ: 0

Batumi:
  –í—Å–µ–≥–æ –º–∞—à–∏–Ω: 25
  –î–æ–±–∞–≤–ª–µ–Ω–æ: 0
  –û–±–Ω–æ–≤–ª–µ–Ω–æ: 25
  –ü—Ä–æ–ø—É—â–µ–Ω–æ: 0

...
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üïê 10.11.2025, 15:00:00
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Jarvis API –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ `46.224.17.15:3000`
2. **Timeout:** 10 –º–∏–Ω—É—Ç (600 —Å–µ–∫—É–Ω–¥) –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞
3. **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** –¢–æ–ª—å–∫–æ –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è (8:00-23:00) –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
4. **–û—à–∏–±–∫–∏:** –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤ Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å endpoint –≤—Ä—É—á–Ω—É—é:

```bash
curl -X POST http://46.224.17.15:3000/restore-cars
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Jarvis API:

```bash
python setup/server_ssh.py "docker logs jarvis-api --tail 100"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ workflow:

1. –û—Ç–∫—Ä–æ–π—Ç–µ workflow –≤ n8n UI
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Executions"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è

- **2025-11-10:** –°–æ–∑–¥–∞–Ω workflow –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –º–∞—à–∏–Ω –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- **2025-11-10:** –î–æ–±–∞–≤–ª–µ–Ω endpoint `/restore-cars` –≤ Jarvis API

