# üìä –°–≤–æ–¥–∫–∞: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω

**–î–∞—Ç–∞:** 2025-11-09  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ—à–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ

---

## üöó –°–ø–∏—Å–æ–∫ –º–∞—à–∏–Ω –±–µ–∑ —Ü–µ–Ω (20 –º–∞—à–∏–Ω)

### –ü–æ —Ñ–∏–ª–∏–∞–ª–∞–º:

| –§–∏–ª–∏–∞–ª | –ë–µ–∑ —Ü–µ–Ω | –ù–µ—Ä–µ–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã |
|--------|---------|-----------------|
| –¢–±–∏–ª–∏—Å–∏ | 9 | 0 |
| –°–µ—Ä–≤–∏—Å–Ω—ã–π —Ü–µ–Ω—Ç—Ä | 5 | 0 |
| –ö—É—Ç–∞–∏—Å–∏ | 3 | 0 |
| –ë–∞—Ç—É–º–∏ | 2 | 0 |
| –ë–µ–∑ —Ñ–∏–ª–∏–∞–ª–∞ | 1 | 0 |
| **–ò–¢–û–ì–û** | **20** | **0** |

**–•–æ—Ä–æ—à–∞—è –Ω–æ–≤–æ—Å—Ç—å:** –£ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—à–∏–Ω —Å —Ü–µ–Ω–∞–º–∏ –Ω–µ—Ç –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (‚â§10 GEL)!

<details>
<summary>üìã –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –º–∞—à–∏–Ω –±–µ–∑ —Ü–µ–Ω (–∫–ª–∏–∫ –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è)</summary>

### –¢–±–∏–ª–∏—Å–∏:
1. BMW 430i Cabrio (IV430AN)
2. Chevrolet Cruze HR (BZ551ZB)
3. Honda HR-V (RV933RR)
4. Honda Odyssey (CR106CR)
5. Mazda 3 (NN371KN)
6. Mazda 6 (NN626CC)
7. Toyota Rav 4 (EP021EP)
8. Toyota Rav 4 (JU904UU)
9. Volkswagen Tiguan (GT183GG)

### –°–µ—Ä–≤–∏—Å–Ω—ã–π —Ü–µ–Ω—Ç—Ä:
1. Buick Encore (UN522UN)
2. Hyundai Tucson (EE377EI)
3. Hyundai Veloster (MM423QM)
4. Volkswagen Jetta (HG541HG)
5. Volkswagen Tiguan (BB681BF)

### –ö—É—Ç–∞–∏—Å–∏:
1. Hyundai Veloster (II179IE)
2. Kia Sportage (WT572WT)
3. Mercedes GLS 450 (WX370WX)

### –ë–∞—Ç—É–º–∏:
1. Kia Sportage (DF368DD)
2. Porsche Cayenne GTS (AR958ES)

### –ë–µ–∑ —Ñ–∏–ª–∏–∞–ª–∞:
1. Mini Cooper S (FH785FH)

</details>

**–ü—Ä–∏—á–∏–Ω–∞:** –≠—Ç–∏ –º–∞—à–∏–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ RentProg API –∏–ª–∏ —É –Ω–∏—Ö –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Ü–µ–Ω—ã —Ç–∞–º.

---

## üîÑ –†–µ—à–µ–Ω–∏–µ: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫–∏

### –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:

‚úÖ **–£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ï–¥–∏–Ω—ã–π –≤–µ–±—Ö—É–∫ RentProg: `https://webhook.rentflow.rentals/`
- –°–æ–±—ã—Ç–∏—è: `booking.*`, `car.moved`, `client.*`
- Workflow: n8n ‚Üí events ‚Üí Jarvis API ‚Üí upsert

‚ùå **–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω
- –°–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥: Daily Sync

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–ü–æ—á–µ–º—É —ç—Ç–æ –ª—É—á—à–µ:**
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–µ–±—Ö—É–∫–æ–≤ (–Ω–∞–¥–µ–∂–Ω–µ–µ)
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Ü–µ–Ω
- ‚úÖ –ü—Ä–æ—â–µ –≤–Ω–µ–¥—Ä–∏—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
- ‚úÖ –ú–æ–∂–µ—Ç –≤—ã—è–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
[Cron: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00]
    ‚Üì
[–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞]
    ‚Üì
[GET /sync-prices/:branch]
    ‚Üì
[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –∏–∑ RentProg]
    ‚Üì
[Telegram: –æ—Ç—á–µ—Ç –æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏]
```

---

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–§–∞–π–ª: `setup/sync_prices_module.mjs`

```javascript
export async function syncPricesForBranch(branch) {
  // 1. –ü–æ–ª—É—á–∏—Ç—å token –æ—Ç RentProg
  // 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –º–∞—à–∏–Ω—ã —Ñ–∏–ª–∏–∞–ª–∞
  // 3. –î–ª—è –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω—ã upsert —Ü–µ–Ω—ã
  // 4. –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
}
```

**–ö–æ–¥ –≥–æ—Ç–æ–≤:** –°–º. `PRICE_SYNC_API_ENDPOINT.md`

---

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å endpoint –≤ Jarvis API

–§–∞–π–ª: `src/api/index.ts`

```typescript
app.get('/sync-prices/:branch', async (req, res) => {
  const result = await syncPricesForBranch(req.params.branch);
  res.json({ ok: true, ...result });
});
```

**–ö–æ–¥ –≥–æ—Ç–æ–≤:** –°–º. `PRICE_SYNC_API_ENDPOINT.md`

---

### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å n8n Workflow

–§–∞–π–ª: `n8n-workflows/daily-price-sync.json`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- Schedule Trigger (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00)
- Split –ø–æ —Ñ–∏–ª–∏–∞–ª–∞–º (tbilisi, batumi, kutaisi, service-center)
- HTTP Request ‚Üí `/sync-prices/:branch`
- Telegram Alert —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

**Workflow –≥–æ—Ç–æ–≤:** –°–º. `n8n-workflows/daily-price-sync.json`

---

### –®–∞–≥ 4: –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ n8n

```bash
# –ß–µ—Ä–µ–∑ n8n UI:
# Settings ‚Üí Import from File ‚Üí daily-price-sync.json

# –ò–ª–∏ —á–µ—Ä–µ–∑ API:
curl -X POST https://n8n.rentflow.rentals/api/v1/workflows \
  -H "X-N8N-API-KEY: $N8N_API_KEY" \
  -H "Content-Type: application/json" \
  -d @n8n-workflows/daily-price-sync.json
```

---

### –®–∞–≥ 5: –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å workflow

–í n8n UI:
1. –û—Ç–∫—Ä—ã—Ç—å workflow "Daily Price Sync"
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ä–µ–º—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3:00)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Telegram credentials
4. **Activate** ‚úÖ

---

## üéØ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥: Real-time —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫–∏

–ï—Å–ª–∏ RentProg –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω:

### –®–∞–≥ 1: –£–∑–Ω–∞—Ç—å –∫–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –æ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç

–í–æ–∑–º–æ–∂–Ω—ã–µ —Ç–∏–ø—ã:
- `car.price.updated`
- `season.updated`
- `price.updated`

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫

```typescript
app.post('/webhook/price-updated', async (req, res) => {
  const { branch, car_id } = req.body;
  res.json({ ok: true }); // –ë—ã—Å—Ç—Ä—ã–π ACK
  
  // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—ã
  await updateCarPrices(branch, car_id);
});
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å n8n Workflow –¥–ª—è —Å–æ–±—ã—Ç–∏–π

```
[Webhook Trigger: price.updated]
    ‚Üì
[POST /webhook/price-updated]
    ‚Üì
[Telegram Alert –ø—Ä–∏ –æ—à–∏–±–∫–µ]
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π | Daily Sync | Real-time Webhooks |
|----------|------------|-------------------|
| **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** | ‚úÖ –í—ã—Å–æ–∫–∞—è | ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç RentProg |
| **–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å** | ‚ö†Ô∏è –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–æ 24—á | ‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å** | ‚úÖ –ü—Ä–æ—Å—Ç–æ–π | ‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–π |
| **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API** | ‚ö†Ô∏è –†–∞–∑ –≤ –¥–µ–Ω—å –≤—Å—ë | ‚úÖ –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è |
| **–í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è** | ‚úÖ 1-2 —á–∞—Å–∞ | ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç RentProg |

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ù–∞—á–Ω–∏—Ç–µ —Å Daily Sync:**

1. ‚úÖ –í–Ω–µ–¥—Ä–∏—Ç–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é (1-2 —á–∞—Å–∞)
2. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω
3. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ –æ—Ç—á–µ—Ç—ã
4. üîú –ü–æ–∑–∂–µ –¥–æ–±–∞–≤—å—Ç–µ real-time webhooks (–µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ—ç—Ç–∞–ø–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–≥–æ–¥–Ω—è)
- –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å (–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤)
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏
- –ú–æ–∂–Ω–æ —É–ª—É—á—à–∞—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### Daily Sync (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

- [ ] –°–æ–∑–¥–∞—Ç—å `setup/sync_prices_module.mjs`
- [ ] –î–æ–±–∞–≤–∏—Ç—å endpoint `/sync-prices/:branch` –≤ Jarvis API
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å: `curl http://localhost:3000/sync-prices/tbilisi`
- [ ] –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å Jarvis API
- [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `daily-price-sync.json` –≤ n8n
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram credentials –≤ workflow
- [ ] –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å workflow
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (–≤—Ä—É—á–Ω—É—é Execute)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

### Real-time Webhooks (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

- [ ] –£–∑–Ω–∞—Ç—å —É RentProg –∫–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –æ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç payload
- [ ] –°–æ–∑–¥–∞—Ç—å endpoint `/webhook/price-updated`
- [ ] –°–æ–∑–¥–∞—Ç—å n8n workflow –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–æ–±—ã—Ç–∏–∏
- [ ] –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ü–µ–Ω –≤ –¥–µ–Ω—å
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ú–∞—à–∏–Ω—ã –±–µ–∑ —Ü–µ–Ω (–¥–æ–ª–∂–Ω–æ —É–º–µ–Ω—å—à–∞—Ç—å—Å—è)
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –ê–ª–µ—Ä—Ç—ã:

- ‚ùå –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–∞–ª–µ–Ω–∞
- ‚ö†Ô∏è –ë–æ–ª–µ–µ 10 –æ—à–∏–±–æ–∫ –∑–∞ —Ä–∞–∑
- ‚ö†Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è >10 –º–∏–Ω—É—Ç
- ‚ÑπÔ∏è –£—Å–ø–µ—à–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (—Ä–∞–∑ –≤ –¥–µ–Ω—å)

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:**
- ‚úÖ –¶–µ–Ω—ã –≤—Å–µ—Ö –º–∞—à–∏–Ω –∞–∫—Ç—É–∞–ª—å–Ω—ã (–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å)
- ‚úÖ –°—Ç–æ—Ä–æ–Ω–Ω–∏–π –±–æ—Ç –≤–∏–¥–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ü–µ–Ω—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã –æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞—à–∏–Ω –±–µ–∑ —Ü–µ–Ω

**–í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:** 1-2 —á–∞—Å–∞  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞:** 2025-11-09  
**–ì–æ—Ç–æ–≤–æ –∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é:** ‚úÖ  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –°–æ–∑–¥–∞—Ç—å `sync_prices_module.mjs` –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ

