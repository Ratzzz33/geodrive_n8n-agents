# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–Ω –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π

**–î–∞—Ç–∞:** 2025-11-09  
**–í—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫:** ~5 –º–∏–Ω—É—Ç

---

## ‚úÖ –ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –≤–æ –≤—Å–µ—Ö —Ñ–∏–ª–∏–∞–ª–∞—Ö RentProg –∏ –Ω–∞—Ö–æ–¥–∏—Ç —Ç–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö **–Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —Ü–µ–Ω—ã –Ω–∞ —Å–µ–∑–æ–Ω—ã**.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –±–µ–∑ —Ü–µ–Ω
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
- ‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å

---

## üèÉ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –†–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–ø—Ä—è–º–æ —Å–µ–π—á–∞—Å)

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞–ø—Ä—è–º—É—é
node setup/check_cars_without_prices.mjs
```

**–í—ã–≤–æ–¥:**
```
üîç –ù–∞—á–∏–Ω–∞—é –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –±–µ–∑ —Ü–µ–Ω –Ω–∞ —Å–µ–∑–æ–Ω—ã...

[tbilisi] –ü–æ–ª—É—á–µ–Ω–∏–µ request token...
[tbilisi] Request token –ø–æ–ª—É—á–µ–Ω, –∏—Å—Ç–µ–∫–∞–µ—Ç: 2025-11-09T12:34:56.000Z
[tbilisi] –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π...
[tbilisi] –ù–∞–π–¥–µ–Ω–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π: 50
[tbilisi] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–Ω –¥–ª—è 50 –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π...

[tbilisi] ‚úÖ ABC123: –µ—Å—Ç—å —Ü–µ–Ω—ã (3/3)
[tbilisi] ‚ùå XYZ789: –ù–ï–¢ –¶–ï–ù (—Å–µ–∑–æ–Ω–æ–≤: 3, —Ü–µ–Ω: 0)
...

[tbilisi] ========== –ò–¢–û–ì–ò ==========
[tbilisi] –í—Å–µ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π: 50
[tbilisi] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ: 50
[tbilisi] –ë–µ–∑ —Ü–µ–Ω: 5
[tbilisi] –° —Ü–µ–Ω–∞–º–∏: 45
[tbilisi] –û—à–∏–±–æ–∫: 0
```

### 2. –ß–µ—Ä–µ–∑ API

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ñ–∏–ª–∏–∞–ª—ã
curl http://46.224.17.15:3000/check-cars-without-prices

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–¥–∏–Ω —Ñ–∏–ª–∏–∞–ª
curl http://46.224.17.15:3000/check-cars-without-prices/tbilisi
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ë–î

```sql
-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã
SELECT * FROM unresolved_price_issues;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–∏–ª–∏–∞–ª–∞–º
SELECT * FROM get_price_issues_stats();
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î

```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É car_price_checks
psql $DATABASE_URL -f setup/migrations/013_create_car_price_checks_table.sql
```

### –®–∞–≥ 2: –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å n8n workflow

```bash
# –ß–µ—Ä–µ–∑ PowerShell (Windows)
powershell -ExecutionPolicy Bypass -File setup/import_single_workflow.ps1 -WorkflowFile "n8n-workflows/check-cars-without-prices.json"
```

–ò–ª–∏ —á–µ—Ä–µ–∑ n8n UI:
1. –û—Ç–∫—Ä—ã—Ç—å https://n8n.rentflow.rentals
2. Workflows ‚Üí Import from File
3. –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª `n8n-workflows/check-cars-without-prices.json`
4. –ù–∞–∂–∞—Ç—å Import

### –®–∞–≥ 3: –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å workflow

–í n8n UI:
1. –ù–∞–π—Ç–∏ workflow **"Check Cars Without Prices"**
2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤ Active

–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è **–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 4:00 —É—Ç—Ä–∞**.

---

## üìä –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –í Telegram

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–¥–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
üö® –ù–∞–π–¥–µ–Ω—ã –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –±–µ–∑ —Ü–µ–Ω –Ω–∞ —Å–µ–∑–æ–Ω—ã

–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚Ä¢ –í—Å–µ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π: 200
‚Ä¢ –ë–µ–∑ —Ü–µ–Ω: 15
‚Ä¢ –° —Ü–µ–Ω–∞–º–∏: 185

–ü–æ —Ñ–∏–ª–∏–∞–ª–∞–º:
‚Ä¢ tbilisi: 5/50 –±–µ–∑ —Ü–µ–Ω
‚Ä¢ batumi: 3/60 –±–µ–∑ —Ü–µ–Ω
‚Ä¢ kutaisi: 4/45 –±–µ–∑ —Ü–µ–Ω
‚Ä¢ service-center: 3/45 –±–µ–∑ —Ü–µ–Ω

‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –≤ RentProg
```

### –í –ë–î (SQL)

```sql
-- –í—Å–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∞–≤—Ç–æ
SELECT * FROM unresolved_price_issues;

-- –ü–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ñ–∏–ª–∏–∞–ª—É
SELECT * FROM unresolved_price_issues WHERE branch = 'tbilisi';

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
SELECT * FROM get_price_issues_stats();
```

### –ß–µ—Ä–µ–∑ API

```bash
# JSON –æ—Ç–≤–µ—Ç —Å–æ –≤—Å–µ–º–∏ –¥–µ—Ç–∞–ª—è–º–∏
curl http://46.224.17.15:3000/check-cars-without-prices | jq
```

---

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω –≤ RentProg

–û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –∫–∞–∫ —Ä–µ—à–µ–Ω–Ω—É—é:

```sql
-- –ù–∞–π—Ç–∏ ID –ø—Ä–æ–≤–µ—Ä–∫–∏
SELECT id, car_number, branch FROM car_price_checks WHERE resolved = FALSE;

-- –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ —Ä–µ—à–µ–Ω–Ω—É—é
SELECT resolve_price_issue(
  'uuid-–ø—Ä–æ–≤–µ—Ä–∫–∏',
  'admin',
  '–¶–µ–Ω—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ RentProg'
);
```

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–Ω–æ–≤–æ - –Ω–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–∑–∞–ø–∏—à—É—Ç —Å—Ç–∞—Ä—ã–µ.

---

## üìù API Endpoints

### `GET /check-cars-without-prices`

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ñ–∏–ª–∏–∞–ª—ã

**–û—Ç–≤–µ—Ç:**
```json
{
  "ok": true,
  "branches": [
    {
      "branch": "tbilisi",
      "total": 50,
      "checked": 50,
      "withoutPrices": 5,
      "withPrices": 45,
      "cars": [...]
    }
  ],
  "summary": {
    "total": 200,
    "withoutPrices": 15,
    "withPrices": 185
  }
}
```

### `GET /check-cars-without-prices/:branch`

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∏–ª–∏–∞–ª

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `branch` - `tbilisi`, `batumi`, `kutaisi`, `service-center`

**–û—Ç–≤–µ—Ç:**
```json
{
  "branch": "tbilisi",
  "total": 50,
  "checked": 50,
  "withoutPrices": 5,
  "withPrices": 45,
  "errors": 0,
  "cars": [
    {
      "rentprogId": "123",
      "code": "Ford Mustang 648",
      "number": "ABC123",
      "model": "Ford Mustang",
      "priceCheck": {
        "hasPrices": false,
        "seasons": 3,
        "pricesCount": 0,
        "details": [...]
      }
    }
  ]
}
```

---

## üîó –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[docs/CAR_PRICE_CHECKS.md](docs/CAR_PRICE_CHECKS.md)** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **[docs/CAR_PRICES_SYNC.md](docs/CAR_PRICES_SYNC.md)** - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ü–µ–Ω
- **[setup/check_cars_without_prices.mjs](setup/check_cars_without_prices.mjs)** - –ö–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞

---

## ‚ú® –ß—Ç–æ –¥–∞–ª—å—à–µ?

1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ n8n
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ë–î –∏–ª–∏ Telegram
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–Ω—ã –≤ RentProg –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∞–≤—Ç–æ
5. ‚úÖ –û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –∫–∞–∫ —Ä–µ—à–µ–Ω–Ω—ã–µ –≤ –ë–î

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–º. –ø–æ–ª–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: [docs/CAR_PRICE_CHECKS.md](docs/CAR_PRICE_CHECKS.md)

