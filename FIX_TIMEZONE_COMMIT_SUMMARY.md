# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç –∏–∑ RentProg

**–î–∞—Ç–∞:** 2025-11-21  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

---

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `parseRentProgDate`

**–§–∞–π–ª:** `src/db/upsert.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω —è–≤–Ω—ã–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å `+04:00` (Asia/Tbilisi) –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –¥–∞—Ç
- –§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ë—ã–ª–æ:**
```typescript
return new Date(`${year}-${month}-${day}T${hour}:${minute}:00`);
```

**–°—Ç–∞–ª–æ:**
```typescript
return new Date(`${year}-${month}-${day}T${hour}:${minute}:00+04:00`);
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã

**–§–∞–π–ª:** `src/db/upsert.test.ts`

**–î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è:**
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ DD-MM-YYYY HH:mm —Å —á–∞—Å–æ–≤—ã–º –ø–æ—è—Å–æ–º
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ null/undefined
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ Date –æ–±—ä–µ–∫—Ç–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å—Å–∏–≤–æ–≤ –¥–∞—Ç
- ‚úÖ –†–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ ISO —Ñ–æ—Ä–º–∞—Ç –∫–∞–∫ fallback

### 3. –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–§–∞–π–ª:** `docs/BOOKING_DATES_TIMEZONE_ISSUE.md`

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- –ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏
- –†–µ—à–µ–Ω–∏–µ
- –ü—Ä–∏–º–µ—Ä—ã –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 4. –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

**–§–∞–π–ª:** `setup/check_booking_changes_qz101qq.mjs`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –±—Ä–æ–Ω–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å –¥–∞—Ç–∞–º–∏

---

## üß™ –¢–µ—Å—Ç—ã

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
npm test
# –∏–ª–∏
npx vitest run src/db/upsert.test.ts
```

---

## üìù –ö–æ–º–º–∏—Ç

```bash
git commit -m "fix: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç –∏–∑ RentProg —Å —É—á–µ—Ç–æ–º —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ Asia/Tbilisi

- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è parseRentProgDate –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞
- –î–æ–±–∞–≤–ª–µ–Ω —è–≤–Ω—ã–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å +04:00 (Asia/Tbilisi) –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –¥–∞—Ç
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è parseRentProgDate
- –°–æ–∑–¥–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç BOOKING_DATES_TIMEZONE_ISSUE.md —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è parseRentProgDate –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"
```

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –î–∞—Ç—ã –∏–∑ RentProg –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å—è—Ç—Å—è —Å —É—á–µ—Ç–æ–º —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ Asia/Tbilisi
- ‚úÖ `start_at` –∏ `end_at` —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º
- ‚úÖ `start_date` –∏ `end_date` –±—É–¥—É—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–∑ `start_at`/`end_at`

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `src/db/upsert.ts` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- `src/db/upsert.test.ts` - —Ç–µ—Å—Ç—ã
- `docs/BOOKING_DATES_TIMEZONE_ISSUE.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `setup/check_booking_changes_qz101qq.mjs` - —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

