# –û—Ç—á–µ—Ç: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ Starline API

**–î–∞—Ç–∞:** 2025-11-14  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

---

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–°–∫–æ—Ä–æ—Å—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ **0 –∫–º/—á**, —Ö–æ—Ç—è –º–∞—à–∏–Ω—ã –¥–≤–∏–≥–∞–ª–∏—Å—å.

**–ü—Ä–∏–º–µ—Ä:**
```
üöó Maserati levante SQ4 ‚Äî WQ686WQ
üìä –°—Ç–∞—Ç—É—Å: üü° gps_offline
üöó –î–≤–∏–∂–µ—Ç—Å—è
‚ö° –°–∫–æ—Ä–æ—Å—Ç—å: 0 –∫–º/—á  ‚Üê –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!
```

---

## üîç –ü—Ä–∏—á–∏–Ω–∞

**–ö–æ–¥ –∏—Å–∫–∞–ª –ø–æ–ª–µ `pos.speed`, –Ω–æ –≤ Starline API —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `pos.s`!**

```typescript
// ‚ùå –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
const speed = pos.speed ?? 0;  // pos.speed –≤—Å–µ–≥–¥–∞ undefined

// ‚úÖ –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
const speed = pos.s ?? 0;      // pos.s —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å
```

---

## üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã TypeScript (4 —Ñ–∞–π–ª–∞):

**`src/services/starline-scraper.ts`:**
```typescript
interface StarlineDeviceOverview {
  pos?: {
    x: number;
    y: number;
    sat_qty: number;
    ts: number;
    dir?: number;     // –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–≥—Ä–∞–¥—É—Å—ã)
    s?: number;       // ‚úÖ –°–ö–û–†–û–°–¢–¨ (–∫–º/—á) - –ø–æ–ª–µ "s", –∞ –Ω–µ "speed"!
  };
}
```

**`src/services/starline-monitor.ts`:**
```typescript
// –°—Ç—Ä–æ–∫–∞ 437-438:
// –í–ê–ñ–ù–û: –ø–æ–ª–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ Starline API –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è "s", –∞ –Ω–µ "speed"!
const speed = pos.s ?? 0;
```

**`src/utils/starline-helpers.ts`:**
```typescript
interface StarlinePosition {
  x: number;
  y: number;
  sat_qty: number;
  ts: number;
  dir?: number;
  s?: number;  // ‚úÖ –°–∫–æ—Ä–æ—Å—Ç—å
}
```

**`src/integrations/starline-client.ts`:**
```typescript
interface StarlinePosition {
  x: number;
  y: number;
  sat_qty: number;
  ts: number;
  dir?: number;
  s?: number;  // ‚úÖ –°–∫–æ—Ä–æ—Å—Ç—å
}
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π

–¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ —á—Ç–æ **–ù–ï–¢ –ø–æ–¥–æ–±–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º** —Å –¥—Ä—É–≥–∏–º–∏ —á–∏—Å–ª–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏:

| –ü–æ–ª–µ | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–≤–µ—Ä–∫–∞ |
|------|--------|----------|
| **–°–∫–æ—Ä–æ—Å—Ç—å (speed)** | ‚ùå ‚Üí ‚úÖ | **–ò–°–ü–†–ê–í–õ–ï–ù–û** (pos.speed ‚Üí pos.s) |
| **–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –±–∞—Ç–∞—Ä–µ–∏ (battery_voltage)** | ‚úÖ | **–ö–û–†–†–ï–ö–¢–ù–û** (8 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, 12.1V-12.8V) |
| **GPS —É—Ä–æ–≤–µ–Ω—å (gps_level)** | ‚úÖ | **–ö–û–†–†–ï–ö–¢–ù–û** (11 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, 0-11) |
| **GSM —É—Ä–æ–≤–µ–Ω—å (gsm_level)** | ‚úÖ | **–ö–û–†–†–ï–ö–¢–ù–û** (11 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, 11-31) |
| **–î–∏—Å—Ç–∞–Ω—Ü–∏—è (distance_moved)** | ‚úÖ | **–ö–û–†–†–ï–ö–¢–ù–û** (–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ) |

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –±–∞—Ç–∞—Ä–µ–∏:
```
‚úÖ –ü–æ–ª–µ battery –≤ Starline API —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚úÖ –ú–∞–ø–ø–∏–Ω–≥ deviceDetails.battery ‚Üí battery_voltage –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
‚úÖ –î–∞–Ω–Ω—ã–µ –≤ –ë–î —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –º–µ–∂–¥—É –º–∞—à–∏–Ω–∞–º–∏ (8 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
‚úÖ –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ Maserati: 12.8V ‚Üí 12.2V)
‚úÖ –î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π (12.1V - 12.8V)
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```javascript
// Maserati Levante –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ Starline API:
const mockDevice = {
  alias: "Maserati levante SQ4 686",
  pos: {
    dir: 313,
    s: 102,  // ‚úÖ –°–ö–û–†–û–°–¢–¨ 102 –∫–º/—á
    sat_qty: 11,
    ts: 1763094317,
    x: 42.163113,
    y: 42.94388
  }
};

// –°—Ç–∞—Ä—ã–π –∫–æ–¥:
const oldSpeed = mockDevice.pos.speed ?? 0;  // 0 –∫–º/—á ‚ùå

// –ù–æ–≤—ã–π –∫–æ–¥:
const newSpeed = mockDevice.pos.s ?? 0;      // 102 –∫–º/—á ‚úÖ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:** ‚úÖ **–ü–†–û–ô–î–ï–ù**

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Starline API

### –û—Ç–≤–µ—Ç `/device/{id}`:
```json
{
  "alias": "Maserati levante SQ4 686",
  "device_id": 869573070110263,
  "position": {
    "dir": 313,      // –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–≥—Ä–∞–¥—É—Å—ã)
    "s": 102,        // ‚Üê –°–ö–û–†–û–°–¢–¨ 102 –∫–º/—á!
    "sat_qty": 11,   // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤
    "ts": 1763094317, // timestamp
    "x": 42.94388,   // longitude
    "y": 42.163113   // latitude
  },
  "battery": 12.8,   // –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –±–∞—Ç–∞—Ä–µ–∏ (–í)
  "gps_lvl": 11,     // —É—Ä–æ–≤–µ–Ω—å GPS (0-31)
  "gsm_lvl": 28,     // —É—Ä–æ–≤–µ–Ω—å GSM (0-31)
  "status": 1        // 0=offline, 1=online
}
```

**–í–∞–∂–Ω–æ:** –ü–æ–ª–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç **—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º–∞—à–∏–Ω–∞ –¥–≤–∏–∂–µ—Ç—Å—è** (`dir` –∏ `s` –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ).

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ Maserati Levante —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å: **102 –∫–º/—á**
- ‚úÖ –í –ë–î —Ç–∞–±–ª–∏—Ü–µ `speed_history` –±—É–¥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ –í —Ç–∞–±–ª–∏—Ü–µ `gps_tracking` –ø–æ–ª–µ `speed` –±—É–¥–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º
- ‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–∫–∞–∂—É—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ:
```
üöó Maserati levante SQ4 ‚Äî WQ686WQ
üìä –°—Ç–∞—Ç—É—Å: üü¢ moving
üöó –î–≤–∏–∂–µ—Ç—Å—è
‚ö° –°–∫–æ—Ä–æ—Å—Ç—å: 102 –∫–º/—á  ‚Üê –ü–†–ê–í–ò–õ–¨–ù–û! ‚úÖ
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å `starline-monitor`** —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –ë–î
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–µ–Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î** - —Ç–∞–±–ª–∏—Ü—ã `gps_tracking` –∏ `speed_history` –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Telegram** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `src/services/starline-scraper.ts` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã Starline API
- `src/services/starline-monitor.ts` - –ø–∞—Ä—Å–∏–Ω–≥ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö GPS
- `src/utils/starline-helpers.ts` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `src/integrations/starline-client.ts` - –∫–ª–∏–µ–Ω—Ç Starline API

---

**–ê–≤—Ç–æ—Ä:** AI Agent  
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** MCP Chrome DevTools (–ø—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Starline API)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ

