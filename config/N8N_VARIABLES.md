# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è n8n

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ n8n –ø—Ä–æ–µ–∫—Ç–µ.

---

## –¢–∏–ø—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

### üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –£–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `docker-compose.yml`
- –¢—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ n8n API

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –î–æ—Å—Ç—É–ø–Ω—ã –≤ workflow –∫–∞–∫ `{{ $env.VARIABLE_NAME }}`
- –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å —á–µ—Ä–µ–∑ n8n Settings API (–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö)
- –¢–∞–∫–∂–µ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `docker-compose.yml`

---

## –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

| –ò–º—è | –¢–∏–ø | –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ | –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|-----|-------------------|------------------|----------|
| **Webhook URLs** |||||
| `WEBHOOK_URL` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `https://webhook.rentflow.rentals` | –ë–∞–∑–æ–≤—ã–π URL –¥–ª—è production webhook |
| `N8N_WEBHOOK_URL` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `https://webhook.rentflow.rentals` | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π webhook URL |
| `WEBHOOK_TEST_URL` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `https://webhook-test.rentflow.rentals` | URL –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö webhook |
| **n8n Host –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** |||||
| `N8N_HOST` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `46.224.17.15` | IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ n8n |
| `N8N_PORT` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `5678` | –ü–æ—Ä—Ç n8n |
| `N8N_PROTOCOL` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `http` | –ü—Ä–æ—Ç–æ–∫–æ–ª (http/https) |
| `N8N_EDITOR_BASE_URL` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `http://46.224.17.15:5678` | –ë–∞–∑–æ–≤—ã–π URL —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** |||||
| `N8N_ENCRYPTION_KEY` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) | –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** |||||
| `POSTGRES_HOST` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `ep-rough-heart-ahnybmq0-pooler.c-3.us-east-1.aws.neon.tech` | –•–æ—Å—Ç PostgreSQL (Neon) |
| `POSTGRES_PORT` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `5432` | –ü–æ—Ä—Ç PostgreSQL |
| `POSTGRES_DB` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `neondb` | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `POSTGRES_USER` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `neondb_owner` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î |
| `POSTGRES_PASSWORD` | –°–∏—Å—Ç–µ–º–Ω–∞—è | ‚úÖ –î–∞ | `npg_cHIT9Kxfk1Am` | –ü–∞—Ä–æ–ª—å –ë–î |
| **API Endpoints** |||||
| `RENTPROG_HEALTH_URL` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è | ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | `http://46.224.17.15:3000/rentprog/health` | URL –¥–ª—è health check RentProg |
| `ORCHESTRATOR_URL` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è | ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | `http://46.224.17.15:3000` | URL –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| `API_BASE_URL` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è | ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | `https://api.rentflow.rentals` | –ë–∞–∑–æ–≤—ã–π URL API |
| `SYNC_STATUS_URL` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è | ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | `https://geodrive.netlify.app/api/sync/status` | URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ |
| **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** |||||
| `TELEGRAM_ALERT_CHAT_ID` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è | ‚ùå –ù–µ—Ç | `-5004140602` | ID —á–∞—Ç–∞ –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤ –≤ Telegram |

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é

### –î–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

1. **–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
   ```bash
   python setup/manage_n8n_variables.py update WEBHOOK_URL=https://new-url.com
   ```

2. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º:**
   ```bash
   python setup/manage_n8n_variables.py sync
   ```

   –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
   ```bash
   # –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
   cd /root/geodrive_n8n-agents
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å docker-compose.yml
   docker compose stop n8n
   docker compose up -d n8n
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
   ```bash
   python setup/server_ssh.py "docker exec n8n printenv WEBHOOK_URL"
   ```

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ manager (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```bash
python setup/manage_n8n_variables.py update TELEGRAM_ALERT_CHAT_ID=-123456789
python setup/manage_n8n_variables.py sync
```

**–°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ n8n Settings API** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
```python
# –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
```

**–°–ø–æ—Å–æ–± 3: –í—Ä—É—á–Ω—É—é –≤ docker-compose.yml**
1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `docker-compose.yml`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

### –õ–æ–∫–∞–ª—å–Ω–æ
```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
python setup/manage_n8n_variables.py list

# –¢–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–Ω—ã–µ
python setup/manage_n8n_variables.py list --type system

# –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ
python setup/manage_n8n_variables.py list --type user
```

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
# –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
python setup/server_ssh.py "docker exec n8n printenv"

# –¢–æ–ª—å–∫–æ WEBHOOK –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
python setup/server_ssh.py "docker exec n8n printenv | grep WEBHOOK"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```bash
# –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
python setup/validate_env_sync.py

# –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è = –æ—à–∏–±–∫–∏)
python setup/validate_env_sync.py --strict

# –û—Ç—á–µ—Ç
python setup/validate_env_sync.py --report
```

---

## –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### –ü–æ—á–µ–º—É –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ docker-compose.yml?

–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
```bash
docker compose stop n8n && docker compose up -d n8n
```

`docker compose restart n8n` –Ω–µ –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è!

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å?

```bash
python setup/server_ssh.py "docker exec n8n printenv VARIABLE_NAME"
```

### –ú–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —á–µ—Ä–µ–∑ n8n API?

–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - **–ù–ï–¢**, —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ docker-compose.yml –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫.

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - **–ß–ê–°–¢–ò–ß–ù–û**, –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö n8n —á–µ—Ä–µ–∑ Settings API.

### –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è?

–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã: `config/n8n-variables.yaml`

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
- `python setup/sync_variables.py` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å docker-compose.yml
- `python setup/manage_n8n_variables.py sync` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º

---

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

| –°–∫—Ä–∏–ø—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|-----------|
| `setup/manage_n8n_variables.py` | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö |
| `setup/sync_variables.py` | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è YAML ‚Üí docker-compose.yml |
| `setup/validate_env_sync.py` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è |
| `setup/check_env_sync.py` | –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è) |
| `setup/server_ssh.py` | SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É |
| `setup/update_webhook_url.py` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ WEBHOOK_URL |

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
config/n8n-variables.yaml  (–ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã)
           ‚Üì
    setup/sync_variables.py
           ‚Üì
      docker-compose.yml
           ‚Üì
    setup/manage_n8n_variables.py sync
           ‚Üì
    –°–µ—Ä–≤–µ—Ä: docker-compose.yml
           ‚Üì
    docker compose restart n8n
           ‚Üì
    –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä n8n (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã)
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –ø–∞—Ä–æ–ª–∏ –∏ –∫–ª—é—á–∏ –≤ Git!

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env` —Ñ–∞–π–ª –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
```bash
# .env (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
POSTGRES_PASSWORD=your_secure_password
N8N_ENCRYPTION_KEY=your_encryption_key
```

–ó–∞—Ç–µ–º –≤ docker-compose.yml:
```yaml
environment:
  - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
```

---

## –°–º. —Ç–∞–∫–∂–µ

- [SSH_CONNECTION_GUIDE.md](../setup/SSH_CONNECTION_GUIDE.md) - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
- [claude.md](../claude.md) - –†–∞–±–æ—á–∏–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∞–≥–µ–Ω—Ç–∞
- [README.md](../README.md) - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-02  
**–í–µ—Ä—Å–∏—è:** 1.0.0

