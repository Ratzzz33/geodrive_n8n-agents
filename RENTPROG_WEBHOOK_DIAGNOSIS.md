# üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –≤–µ–±—Ö—É–∫–∞–º–∏ RentProg

**–î–∞—Ç–∞:** 2025-11-04  
**–°—Ç–∞—Ç—É—Å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω

---

## üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ

### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
```
RentProg ‚Üí https://webhook.rentflow.rentals ‚Üí Nginx ‚Üí n8n (localhost:5678/webhook/rentprog-webhook)
```

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π URL –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ RentProg:
```
https://webhook.rentflow.rentals
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:**
- URL –±–µ–∑ —Å–ª—ç—à–∞ –≤ –∫–æ–Ω—Ü–µ
- –ë–µ–∑ –ø—É—Ç–∏ `/webhook/rentprog-webhook` 
- –ü—Ä–æ—Å—Ç–æ –¥–æ–º–µ–Ω: `https://webhook.rentflow.rentals`

---

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –Ω–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤–µ–±—Ö—É–∫–æ–≤

### 1. ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π URL –≤ RentProg

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö RentProg –º–æ–∂–µ—Ç –±—ã—Ç—å —É–∫–∞–∑–∞–Ω —Å—Ç–∞—Ä—ã–π –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π URL.

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –í–æ–π–¥–∏—Ç–µ –≤ RentProg –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏** ‚Üí **Webhooks** (–∏–ª–∏ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤–µ–±—Ö—É–∫–∞

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π URL:**
```
https://webhook.rentflow.rentals
```

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–ù–ï —Ä–∞–±–æ—Ç–∞—é—Ç):**
- ‚ùå `https://geodrive.netlify.app/webhooks/rentprog/tbilisi` (—Å—Ç–∞—Ä—ã–π)
- ‚ùå `https://webhook.rentflow.rentals/` (—Å–ª—ç—à –≤ –∫–æ–Ω—Ü–µ –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å)
- ‚ùå `https://webhook.rentflow.rentals/webhook/rentprog-webhook` (–ø—É—Ç—å –Ω–µ –Ω—É–∂–µ–Ω)
- ‚ùå `http://webhook.rentflow.rentals` (–±–µ–∑ SSL)

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å URL –≤ RentProg –¥–ª—è –≤—Å–µ—Ö 4 —Ñ–∏–ª–∏–∞–ª–æ–≤.

---

### 2. ‚ùå –í–µ–±—Ö—É–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ RentProg

**–ü—Ä–æ–±–ª–µ–º–∞:** –í–µ–±—Ö—É–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–µ–±—Ö—É–∫–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∏–ª–∏ —á–µ–∫–±–æ–∫—Å "–ê–∫—Ç–∏–≤–µ–Ω" / "Enabled".

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤–µ–±—Ö—É–∫ –∞–∫—Ç–∏–≤–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞.

---

### 3. ‚ùå SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø—Ä–æ—Å—Ä–æ—á–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è `webhook.rentflow.rentals` –ø—Ä–æ—Å—Ä–æ—á–µ–Ω, RentProg –Ω–µ —Å–º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–µ–±—Ö—É–∫–∏.

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:** –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –Ω–∏–∂–µ –∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```bash
curl -I https://webhook.rentflow.rentals
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:** 
- HTTP/2 200 OK
- –ò–ª–∏ HTTP/2 405 Method Not Allowed (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è GET –Ω–∞ webhook endpoint)

**–û—à–∏–±–∫–∞:** 
- SSL certificate problem
- 502 Bad Gateway
- Connection refused

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
```bash
ssh root@46.224.17.15
certbot renew
nginx -s reload
```

---

### 4. ‚ùå Nginx –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** Nginx –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–æ—Ä—Ç.

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
ssh root@46.224.17.15

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Nginx
systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cat /etc/nginx/sites-available/webhook.rentflow.rentals.conf

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
tail -f /var/log/nginx/webhook-access.log
tail -f /var/log/nginx/webhook-error.log
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```nginx
location / {
    proxy_pass http://localhost:5678/webhook/rentprog-webhook;
    ...
}
```

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx
```bash
nginx -t  # –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
systemctl restart nginx
```

---

### 5. ‚ùå n8n –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ workflow –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** n8n –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ workflow "RentProg Webhooks Monitor" –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω.

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
ssh root@46.224.17.15
docker ps | grep n8n  # –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å UP
```

**–ò–ª–∏ —á–µ—Ä–µ–∑ UI:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://n8n.rentflow.rentals
2. –û—Ç–∫—Ä–æ–π—Ç–µ workflow "RentProg Webhooks Monitor"
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å—Ç–∞—Ç—É—Å: **Active** (–∑–µ–ª—ë–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å)

**–†–µ—à–µ–Ω–∏–µ:** 
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å n8n
docker restart n8n

# –ò–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å workflow —á–µ—Ä–µ–∑ UI
```

---

### 6. ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π webhook path –≤ n8n

**–ü—Ä–æ–±–ª–µ–º–∞:** –í n8n workflow —É–∫–∞–∑–∞–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π –ø—É—Ç—å –≤–µ–±—Ö—É–∫–∞.

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ workflow –≤ n8n UI
2. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–¥—É "Webhook"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä "Path"

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
```
Path: rentprog-webhook
Production URL: https://webhook.rentflow.rentals
```

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å path –≤ –Ω–æ–¥–µ "Webhook".

---

### 7. ‚ùå Firewall –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã

**–ü—Ä–æ–±–ª–µ–º–∞:** Firewall –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ—Ç RentProg.

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
ssh root@46.224.17.15

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ firewall
iptables -L -n | grep 443
ufw status  # –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ufw

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã –ª–∏ –ø–æ—Ä—Ç—ã
netstat -tuln | grep 443
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:** –ü–æ—Ä—Ç 443 –æ—Ç–∫—Ä—ã—Ç –¥–ª—è –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ufw
ufw allow 443/tcp

# –ï—Å–ª–∏ iptables
iptables -A INPUT -p tcp --dport 443 -j ACCEPT
```

---

### 8. ‚ùå RentProg –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–µ–±—Ö—É–∫–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö RentProg –Ω–µ –≤—ã–±—Ä–∞–Ω—ã —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏.

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–µ–±—Ö—É–∫–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π (—Å–æ–±—ã—Ç–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å):
- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ
- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ
- –ê–≤—Ç–æ–º–æ–±–∏–ª—å –æ–±–Ω–æ–≤–ª—ë–Ω
- –ö–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω
- –∏ —Ç.–¥.

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–±—Ä–∞—Ç—å –≤—Å–µ –Ω—É–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–µ–±—Ö—É–∫–∞.

---

### 9. ‚ùå Jarvis API –Ω–µ –∑–∞–ø—É—â–µ–Ω (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

**–ü—Ä–æ–±–ª–µ–º–∞:** Jarvis API –Ω–∞ –ø–æ—Ä—Ç—É 3000 –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç. 

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –≠—Ç–æ –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏—ë–º –≤–µ–±—Ö—É–∫–æ–≤! n8n —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ –ë–î –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç Jarvis API.

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
curl http://46.224.17.15:3000/health
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:** `{"ok":true}`

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç—å Jarvis API
```bash
ssh root@46.224.17.15
cd /root/geodrive_n8n-agents
npm run build
npm start

# –ò–ª–∏ —á–µ—Ä–µ–∑ PM2
pm2 start dist/index.js --name jarvis
pm2 save
```

---

## üß™ –¢–µ—Å—Ç—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–æ–º–µ–Ω–∞

```bash
# –° –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
curl -I https://webhook.rentflow.rentals
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:** HTTP/2 200 OK –∏–ª–∏ 405 Method Not Allowed (–¥–ª—è GET)

**–ï—Å–ª–∏ –æ—à–∏–±–∫–∞:**
- SSL certificate problem ‚Üí –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- Connection refused ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Nginx
- Timeout ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall

---

### –¢–µ—Å—Ç 2: –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –≤–µ–±—Ö—É–∫–∞

```bash
curl -X POST https://webhook.rentflow.rentals \
  -H "Content-Type: application/json" \
  -d '{"event":"test_manual","payload":"{\"id\":999,\"company_id\":9247}"}'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:** –°—Ç–∞—Ç—É—Å 200 OK

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ n8n UI ‚Üí workflow "RentProg Webhooks Monitor" ‚Üí Executions
2. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–π execution —Å –¥–∞–Ω–Ω—ã–º–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ë–î: `SELECT * FROM events WHERE rentprog_id = '999'`

**–ï—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Nginx
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ n8n

---

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Nginx

```bash
ssh root@46.224.17.15

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –≤—Ö–æ–¥—è—â–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f /var/log/nginx/webhook-access.log

# –í –¥—Ä—É–≥–æ–π –≤–∫–ª–∞–¥–∫–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –≤–µ–±—Ö—É–∫
curl -X POST https://webhook.rentflow.rentals \
  -H "Content-Type: application/json" \
  -d '{"event":"test"}'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:** –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Å—Ç—Ä–æ–∫–∞ —Å POST –∑–∞–ø—Ä–æ—Å–æ–º.

**–ï—Å–ª–∏ –Ω–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–∞—Ö:**
- –ü—Ä–æ–±–ª–µ–º–∞ —Å DNS –∏–ª–∏ SSL
- Firewall –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
- Nginx –Ω–µ –∑–∞–ø—É—â–µ–Ω

---

### –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ n8n –Ω–∞–ø—Ä—è–º—É—é

```bash
ssh root@46.224.17.15

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ n8n (–º–∏–Ω—É—è Nginx)
curl -X POST http://localhost:5678/webhook/rentprog-webhook \
  -H "Content-Type: application/json" \
  -d '{"event":"test_direct","payload":"{\"id\":888}"}'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:** –°—Ç–∞—Ç—É—Å 200 OK

**–ï—Å–ª–∏ —Å—Ä–∞–±–æ—Ç–∞–ª–æ:**
- n8n —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ Nginx –∏–ª–∏ SSL

**–ï—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ:**
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ n8n –∏–ª–∏ workflow –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω

---

### –¢–µ—Å—Ç 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
psql "postgresql://neondb_owner:npg_cHIT9Kxfk1Am@ep-rough-heart-ahnybmq0-pooler.c-3.us-east-1.aws.neon.tech/neondb?sslmode=require"

# –í psql –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
SELECT * FROM events ORDER BY ts DESC LIMIT 10;
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:** –ó–∞–ø–∏—Å–∏ —Å –Ω–µ–¥–∞–≤–Ω–∏–º–∏ timestamp.

**–ï—Å–ª–∏ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π:**
- –í–µ–±—Ö—É–∫–∏ –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ n8n
- –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å credentials)

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (46.224.17.15):
- [ ] Nginx –∑–∞–ø—É—â–µ–Ω: `systemctl status nginx`
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤–∞–ª–∏–¥–µ–Ω: `certbot certificates`
- [ ] n8n –∑–∞–ø—É—â–µ–Ω: `docker ps | grep n8n`
- [ ] –õ–æ–≥–∏ Nginx –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
- [ ] –ü–æ—Ä—Ç 443 –æ—Ç–∫—Ä—ã—Ç: `netstat -tuln | grep 443`

### –í n8n UI (https://n8n.rentflow.rentals):
- [ ] Workflow "RentProg Webhooks Monitor" –∞–∫—Ç–∏–≤–µ–Ω
- [ ] Webhook path = `rentprog-webhook`
- [ ] Production URL = `https://webhook.rentflow.rentals`
- [ ] PostgreSQL credentials –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –≤ –Ω–æ–¥–µ "Save Event"
- [ ] Telegram credentials –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –≤ alert –Ω–æ–¥–∞—Ö

### –í RentProg (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞):
- [ ] URL –≤–µ–±—Ö—É–∫–∞ = `https://webhook.rentflow.rentals`
- [ ] –ú–µ—Ç–æ–¥ = POST
- [ ] –§–æ—Ä–º–∞—Ç = JSON
- [ ] –í–µ–±—Ö—É–∫ –∞–∫—Ç–∏–≤–µ–Ω
- [ ] –í—ã–±—Ä–∞–Ω—ã –Ω—É–∂–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

### –í –ë–î (Neon PostgreSQL):
- [ ] –¢–∞–±–ª–∏—Ü–∞ `events` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [ ] –ï—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (–∑–∞ —Å–µ–≥–æ–¥–Ω—è)
- [ ] Company IDs —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ñ–∏–ª–∏–∞–ª–∞–º:
  - 9247 = tbilisi
  - 9248 = kutaisi
  - 9506 = batumi
  - 11163 = service-center

---

## üéØ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
curl -I https://webhook.rentflow.rentals

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
ssh root@46.224.17.15
tail -f /var/log/nginx/webhook-access.log
```

### –®–∞–≥ 2: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –≤–µ–±—Ö—É–∫
```bash
curl -X POST https://webhook.rentflow.rentals \
  -H "Content-Type: application/json" \
  -d '{"event":"booking_update","payload":"{\"id\":12345,\"company_id\":9247}"}'
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
1. –í –ª–æ–≥–∞—Ö Nginx –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å
2. –í n8n UI –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å execution
3. –í –ë–î –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å

### –®–∞–≥ 4: –ï—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ—à—ë–ª, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å RentProg
1. –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–µ–±—Ö—É–∫–∞ –≤ RentProg
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ URL = `https://webhook.rentflow.rentals`
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤–µ–±—Ö—É–∫ –∞–∫—Ç–∏–≤–µ–Ω
4. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ (–æ–±–Ω–æ–≤–∏—Ç—å –±—Ä–æ–Ω—å) –≤ RentProg
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å execution –≤ n8n

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

–û—Ç–∫—Ä–æ–π—Ç–µ 3 —Ç–µ—Ä–º–∏–Ω–∞–ª–∞:

**–¢–µ—Ä–º–∏–Ω–∞–ª 1: –õ–æ–≥–∏ Nginx**
```bash
ssh root@46.224.17.15
tail -f /var/log/nginx/webhook-access.log
```

**–¢–µ—Ä–º–∏–Ω–∞–ª 2: –õ–æ–≥–∏ n8n**
```bash
ssh root@46.224.17.15
docker logs n8n -f | grep -i webhook
```

**–¢–µ—Ä–º–∏–Ω–∞–ª 3: –°–æ–±—ã—Ç–∏—è –≤ –ë–î**
```bash
watch -n 5 'psql "postgresql://neondb_owner:npg_cHIT9Kxfk1Am@ep-rough-heart-ahnybmq0-pooler.c-3.us-east-1.aws.neon.tech/neondb?sslmode=require" -c "SELECT COUNT(*), MAX(ts) FROM events"'
```

–¢–µ–ø–µ—Ä—å –≤ RentProg:
1. –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
2. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –∏ –ë–î

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
- –ó–∞–ø–∏—Å—å –≤ Nginx –ª–æ–≥–∞—Ö
- Execution –≤ n8n
- –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å –≤ –ë–î

---

## üîß –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–∏:
```bash
ssh root@46.224.17.15

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx
systemctl restart nginx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å n8n
docker restart n8n

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
systemctl status nginx
docker ps | grep n8n
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É –ø—Ä–æ–±–ª–µ–º—ã
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (URL –≤ RentProg, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Ç.–¥.)
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ç–µ—Å—Ç–æ–≤—ã–º –≤–µ–±—Ö—É–∫–æ–º
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º —Å–æ–±—ã—Ç–∏–µ–º –∏–∑ RentProg
5. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ Jarvis API –∑–∞–ø—É—â–µ–Ω (–¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏)

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 2025-11-04  
**–ê–≤—Ç–æ—Ä:** Claude Sonnet 4.5  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ
